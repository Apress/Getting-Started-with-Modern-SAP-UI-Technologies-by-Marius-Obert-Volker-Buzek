/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/macros/CommonHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/form/FormTemplating","sap/m/library","sap/ui/base/ManagedObject","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,o,i,r,a,s,l,u){"use strict";var c={};var d=a.getLabelForConnectedFields;var f=r.formatValueRecursively;var v=r.addTextArrangementToBindingExpression;var g=o.enhanceDataModelPath;var p=t.resolveBindingString;var m=t.or;var b=t.not;var T=t.isEmpty;var E=t.ifElse;var y=t.getExpressionFromAnnotation;var A=t.equal;var S=t.constant;var O=t.concat;var C=t.compileExpression;var $=t.and;var D=e.UI;var x=e.Entity;var I=e.Draft;const h=s.ButtonType;const F=function(e,t,n,o){var i,r,a,s;const l=t.resourceModel.getText("T_NEW_OBJECT",undefined,t.entitySet);const u=t.resourceModel.getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE",undefined,t.entitySet);const c=(e===null||e===void 0?void 0:e.Title)===undefined||(e===null||e===void 0?void 0:e.Title)===""||(e===null||e===void 0?void 0:(i=e.Title)===null||i===void 0?void 0:i.Value)==="";const m=!c?t.resourceModel.getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO"):"";let b,A,I=S(true),h;if((e===null||e===void 0?void 0:(r=e.Title)===null||r===void 0?void 0:r.$Type)==="com.sap.vocabularies.UI.v1.DataField"){var F,P,B,V,N,M,_,w,H,j,G;b=y(e===null||e===void 0?void 0:(F=e.Title)===null||F===void 0?void 0:F.Value);if(e!==null&&e!==void 0&&(P=e.Title)!==null&&P!==void 0&&(B=P.Value)!==null&&B!==void 0&&(V=B.$target)!==null&&V!==void 0&&(N=V.annotations)!==null&&N!==void 0&&(M=N.Common)!==null&&M!==void 0&&(_=M.Text)!==null&&_!==void 0&&(w=_.annotations)!==null&&w!==void 0&&(H=w.UI)!==null&&H!==void 0&&H.TextArrangement){b=v(b,n)}b=f(b,n);I=((j=b)===null||j===void 0?void 0:j._type)==="Constant"?S(!((G=b)!==null&&G!==void 0&&G.value)):T(b)}else if((e===null||e===void 0?void 0:(a=e.Title)===null||a===void 0?void 0:a.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(e===null||e===void 0?void 0:(s=e.Title)===null||s===void 0?void 0:s.Target.$target.$Type)==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){var U,R;A=g(n,"$Type/@UI.HeaderInfo/Title/Target/$AnnotationPath");b=d(A,false);h=((U=b)===null||U===void 0?void 0:U._type)==="Constant"?S(!((R=b)!==null&&R!==void 0&&R.value)):T(b);I=b?h:S(true)}const L=e!==null&&e!==void 0&&e.TypeName?O(u,": ",p(e.TypeName.toString())):l;const Q=o?x.IsActive:true;return C(E($(D.IsCreateMode,I),L,E($(Q,I),m,b)))};c.getExpressionForTitle=F;const P=function(e,t){var n,o,i,r,a,s,l,u,c;let d=y(e===null||e===void 0?void 0:(n=e.Description)===null||n===void 0?void 0:n.Value);if(e!==null&&e!==void 0&&(o=e.Description)!==null&&o!==void 0&&(i=o.Value)!==null&&i!==void 0&&(r=i.$target)!==null&&r!==void 0&&(a=r.annotations)!==null&&a!==void 0&&(s=a.Common)!==null&&s!==void 0&&(l=s.Text)!==null&&l!==void 0&&(u=l.annotations)!==null&&u!==void 0&&(c=u.UI)!==null&&c!==void 0&&c.TextArrangement){d=v(d,t)}return C(f(d,t))};c.getExpressionForDescription=P;const B=function(e,t){var n;const o=e.resourceModel.getText("T_OP_OBJECT_PAGE_SAVE");const i=e.resourceModel.getText("T_OP_OBJECT_PAGE_CREATE");let r;if((n=t.startingEntitySet.annotations.Session)!==null&&n!==void 0&&n.StickySessionSupported){r=E(D.IsCreateMode,i,o)}else{r=E(I.IsNewObject,i,o)}return C(r)};c.getExpressionForSaveButton=B;const V=function(e){const t=["Primary","DefaultApply","Secondary","ForAction","ForNavigation","SwitchToActiveObject","SwitchToDraftObject","DraftActions","Copy"];return t.indexOf(e.type)<0};c.isManifestAction=V;const N=function(e){var t,n,o;const i=(t=e.targetEntityType)===null||t===void 0?void 0:(n=t.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.Identification;const r=(i===null||i===void 0?void 0:i.filter(e=>e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.Criticality))||[];const a=r.length?r.map(e=>{var t,n;const o=y(e.Criticality);return $(b(A(y((t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Hidden),true)),m(A(o,"UI.CriticalityType/Negative"),A(o,"1"),A(o,1),A(o,"UI.CriticalityType/Positive"),A(o,"3"),A(o,3)))}):[S(false)];return C(E(m(...a),h.Default,h.Emphasized))};c.buildEmphasizedButtonExpression=N;const M=function(e){const t=u.getNavigationPath(e);if(t){return"{path:'"+t+"'}"}else{return"{path: ''}"}};c.getElementBinding=M;const _=function(e){if(e["@com.sap.vocabularies.Common.v1.DraftRoot"]&&e["@com.sap.vocabularies.Common.v1.DraftRoot"]["EditAction"]){return true}else{return false}};c.checkDraftState=_;const w=function(e){if(_(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( ${ui>/isEditable} && !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};c.getSwitchToActiveVisibility=w;const H=function(e){if(_(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !(${ui>/isEditable}) && !${ui>createMode} && ${HasDraftEntity} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};c.getSwitchToDraftVisibility=H;const j=function(e){if(_(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};c.getSwitchDraftAndActiveVisibility=j;const G=function(e,t){let n;if(e&&e.length){n=e.find(function(e){return e.type===t})}return n};c._findAction=G;const U=function(e){const t=G(e,"Secondary");return t?t.enabled:"true"};c.getDeleteCommandExecutionEnabled=U;const R=function(e){const t=G(e,"Secondary");return t?t.visible:"true"};c.getDeleteCommandExecutionVisible=R;const L=function(e){const t=G(e,"Primary");return t?t.visible:"false"};c.getEditCommandExecutionVisible=L;const Q=function(e){const t=G(e,"Primary");return t?t.enabled:"false"};c.getEditCommandExecutionEnabled=Q;const J=function(e){const t=e.getPath();const n=t.split("/");const o="/"+n[1];const i=e.getObject(o+"@");const r=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftRoot");const a=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftNode");const s=i.hasOwnProperty("@com.sap.vocabularies.Session.v1.StickySessionSupported");let l;if(r){l=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftRoot/EditAction`)}else if(a){l=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftNode/EditAction`)}else if(s){l=e.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`)}return!l?l:`${o}/${l}`};c.getEditAction=J;const k=function(e,t){let n,o,i;if(e&&e["@Org.OData.Core.V1.Computed"]){n=e["@Org.OData.Core.V1.Computed"].Bool?e["@Org.OData.Core.V1.Computed"].Bool=="true":true}if(e&&e["@Org.OData.Core.V1.Immutable"]){o=e["@Org.OData.Core.V1.Immutable"].Bool?e["@Org.OData.Core.V1.Immutable"].Bool=="true":true}i=n||o;if(t){i=i||t=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"}if(i){return true}else{return false}};c.isReadOnlyFromStaticAnnotations=k;const q=function(e){let t;if(e){if(l.bindingParser(e)){t="%"+e+" === 1 "}}if(t){return"{= "+t+"? false : true }"}else{return undefined}};c.readOnlyExpressionFromDynamicAnnotations=q;const W=function(e,t,n){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]||e["targetOutbound"]&&e["targetOutbound"]["outbound"]&&e["targetSections"]){return".handlers.onDataPointTitlePressed($controller, ${$source>/},'"+JSON.stringify(t)+"','"+e["targetOutbound"]["outbound"]+"','"+n+"' )"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};c.getExpressionForMicroChartTitlePress=W;const z=function(e){if(e&&(e["targetOutbound"]||e["targetOutbound"]&&e["targetSections"])){return"External"}else if(e&&e["targetSections"]){return"InPage"}else{return"None"}};c.getMicroChartTitleAsLink=z;const K=function(e,t,n){const o=e[t],i=["Heroes","Decoration","Workers","LongRunners"];let r=n;if(o&&o.requestGroupId&&i.some(function(e){return e===o.requestGroupId})){r="$auto."+o.requestGroupId}return r};c.getGroupIdFromConfig=K;const X=function(e,t){const n=K(e,t);let o;if(n){o="{ path : '', parameters : { $$groupId : '"+n+"' } }"}return o};c.getBindingWithGroupIdFromConfig=X;const Y=function(e){return e&&e.length===1&&!!e[0].isValueMultilineText};c.doesFieldGroupContainOnlyOneMultiLineDataField=Y;const Z=function(e){return e.showBreadCrumbs&&e.fclEnabled!==undefined?"{fclhelper>/breadCrumbIsVisible}":e.showBreadCrumbs};c.getVisibleExpressionForBreadcrumbs=Z;const ee=function(e){let t="!${ui>createMode}";if(e.fclEnabled){t="${fclhelper>/showShareIcon} && "+t}if(e.isShareButtonVisibleForMyInbox===false){return"false"}return"{= "+t+" }"};c.getShareButtonVisibility=ee;const te=function(e,t,n,o){const i=e?k(e,n):true;const r=q(n);if(!i&&!r){return true}const a=t?k(t,o):true;const s=q(o);if(!a&&!s){return true}if(i&&a&&!r&&!s){return false}if(r&&!s){return r}else if(!r&&s){return s}else{return ne(n,o)}};c.getVisiblityOfHeaderInfo=te;const ne=function(e,t){return"{= %"+e+" === 1 ? ( %"+t+" === 1 ? false : true ) : true }"};c.combineTitleAndDescriptionExpression=ne;const oe=function(e,t){const o="${$view>/getBindingContext}",r="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedHeading/getItems/1/getText}",a="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedContent/0/getItems/0/getText}";const s=t&&t.context;const l=s.getPath();const u=l.split("/").filter(n.filterOutNavPropBinding);const c=u.length>1?s.getModel().getObject(`/${u.join("/")}@sapui.name`):u[0];const d={title:r,entitySetName:i.addSingleQuotes(c),description:a};return i.generateFunction(".editFlow.deleteDocument",o,i.objectToString(d))};oe.requiresIContext=true;c.getPressExpressionForDelete=oe;const ie=function(e,t,n){const o=i.addSingleQuotes(e&&e.Action),r=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],a=r==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const s={contexts:"${$view>/getBindingContext}",entitySetName:i.addSingleQuotes(t),invocationGrouping:i.addSingleQuotes(a),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return i.generateFunction(".handlers.onCallAction","${$view>/}",o,i.objectToString(s))};c.getPressExpressionForEdit=ie;const re=function(e,t,n){const o=i.addSingleQuotes(e.Action),r=e.InvocationGrouping,a=r==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const s={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:i.addSingleQuotes(t),invocationGrouping:i.addSingleQuotes(a),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return i.generateFunction(".handlers.onCallAction","${$view>/}",o,i.objectToString(s))};c.getPressExpressionForFooterAnnotationAction=re;const ae=function(e,t,n,o,r,a,s){const l=i.addSingleQuotes(e&&e.Action),u=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],c=u==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const d={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:t?i.addSingleQuotes(t):"",invocationGrouping:i.addSingleQuotes(c),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e===null||e===void 0?void 0:e.Label,true),isNavigable:n===null||n===void 0?void 0:n.isNavigable,defaultValuesExtensionFunction:n!==null&&n!==void 0&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};const f={positiveActionVisible:o,positiveActionEnabled:r,editActionVisible:a,editActionEnabled:s};return i.generateFunction(".handlers.onPrimaryAction","$controller","${$view>/}","${$view>/getBindingContext}",l,i.objectToString(d),i.objectToString(f))};c.getPressExpressionForPrimaryAction=ae;const se=function(e,t){if(t&&t.Facet&&t.Facet.targetAnnotationType==="DataPoint"){return X(e,t.Facet.targetAnnotationValue)}};c.getStashableHBoxBinding=se;const le=function(e,t){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]){return".handlers.onDataPointTitlePressed($controller, ${$source>}, "+JSON.stringify(t)+","+JSON.stringify(e["targetOutbound"]["outbound"])+")"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};c.getPressExpressionForLink=le;const ue=function(e){var t;if((e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:t.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return undefined}return"Bare"};c.getHeaderFormHboxRenderType=ue;function ce(e,t,n,o){if(t.defaultAction){try{switch(t.defaultAction.type){case"ForAction":{return ie(n,o,t.defaultAction)}case"ForNavigation":{if(t.defaultAction.command){return"cmd:"+t.defaultAction.command}else{return t.defaultAction.press}}default:{if(t.defaultAction.command){return"cmd:"+t.defaultAction.command}if(t.defaultAction.noWrap){return t.defaultAction.press}else{return i.buildActionWrapper(t.defaultAction,{id:"forTheObjectPage"})}}}}catch(e){return"binding for the default action is not working as expected"}}return undefined}c.getDefaultActionHandler=ce;function de(e){return e.isPartOfPreview===true||e.presentation.visualizations[0].type!=="Table"}c.isVisualizationIsPartOfPreview=de;return c},false);