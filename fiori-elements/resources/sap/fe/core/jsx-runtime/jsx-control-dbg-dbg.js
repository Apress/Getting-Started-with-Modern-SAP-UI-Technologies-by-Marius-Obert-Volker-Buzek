/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/helpers/BindingToolkit", "sap/m/Text", "sap/ui/base/DataType"], function (BindingToolkit, Text, DataType) {
  "use strict";

  var isConstant = BindingToolkit.isConstant;
  var compileExpression = BindingToolkit.compileExpression;
  var compileConstant = BindingToolkit.compileConstant;
  const addChildAggregation = function (aggregationChildren, aggregationName, child) {
    if (child === undefined || typeof child === "string") {
      return;
    }
    if (!aggregationChildren[aggregationName]) {
      aggregationChildren[aggregationName] = [];
    }
    if (isChildAnElement(child)) {
      aggregationChildren[aggregationName].push(child);
    } else if (Array.isArray(child)) {
      child.forEach(subChild => {
        addChildAggregation(aggregationChildren, aggregationName, subChild);
      });
    } else {
      Object.keys(child).forEach(childKey => {
        addChildAggregation(aggregationChildren, childKey, child[childKey]);
      });
    }
  };
  const isChildAnElement = function (children) {
    var _isA, _ref;
    return children === null || children === void 0 ? void 0 : (_isA = (_ref = children).isA) === null || _isA === void 0 ? void 0 : _isA.call(_ref, "sap.ui.core.Element");
  };
  const isAControl = function (children) {
    return !!(children !== null && children !== void 0 && children.getMetadata);
  };
  function processAggregations(metadata, mSettings) {
    const metadataAggregations = metadata.getAllAggregations();
    const defaultAggregationName = metadata.getDefaultAggregationName();
    const aggregationChildren = {};
    addChildAggregation(aggregationChildren, defaultAggregationName, mSettings.children);
    delete mSettings.children;
    // find out which aggregation are bound (both in children and directly under it)
    Object.keys(metadataAggregations).forEach(aggregationName => {
      if (aggregationChildren[aggregationName] !== undefined) {
        if (mSettings.hasOwnProperty(aggregationName)) {
          // always use the first item as template according to UI5 logic
          mSettings[aggregationName].template = aggregationChildren[aggregationName][0];
        } else {
          mSettings[aggregationName] = aggregationChildren[aggregationName];
        }
      }
    });
  }

  /**
   * Processes the properties.
   *
   * If the property is a bindingToolkit expression we need to compile it.
   * Else if the property is set as string (compiled binding expression returns string by default even if it's a boolean, int, etc.) and it doesn't match with expected
   * format the value is parsed to provide expected format.
   *
   * @param metadata Metadata of the control
   * @param settings Settings of the control
   * @returns {void}
   */
  function processProperties(metadata, settings) {
    let settingsKey;
    for (settingsKey in settings) {
      const value = settings[settingsKey];
      if (value !== null && value !== void 0 && value._type) {
        const bindingToolkitExpression = value;
        if (isConstant(bindingToolkitExpression)) {
          settings[settingsKey] = compileConstant(value, false, true, true);
        } else {
          settings[settingsKey] = compileExpression(bindingToolkitExpression);
        }
      } else if (typeof settings[settingsKey] === "string" && !settings[settingsKey].startsWith("{")) {
        var _metadata$getAllPrope, _metadata$getAllPrope2, _metadata$getAllPrope3;
        const propertyType = (_metadata$getAllPrope = metadata.getAllProperties()[settingsKey]) === null || _metadata$getAllPrope === void 0 ? void 0 : (_metadata$getAllPrope2 = (_metadata$getAllPrope3 = _metadata$getAllPrope).getType) === null || _metadata$getAllPrope2 === void 0 ? void 0 : _metadata$getAllPrope2.call(_metadata$getAllPrope3);
        if (propertyType && propertyType instanceof DataType && ["boolean", "int", "float"].indexOf(propertyType.getName()) > -1) {
          settings[settingsKey] = propertyType.parseValue(value);
        }
      }
    }
  }
  const jsxControl = function (ControlType, mSettings, key, jsxContext) {
    let targetControl;
    if (ControlType !== null && ControlType !== void 0 && ControlType.isFragment) {
      targetControl = mSettings.children;
    } else if (ControlType !== null && ControlType !== void 0 && ControlType.isRuntime) {
      const runtimeBuildingBlock = new ControlType(mSettings);
      targetControl = runtimeBuildingBlock.getContent(jsxContext.view, jsxContext.appComponent);
    } else if (isAControl(ControlType)) {
      const metadata = ControlType.getMetadata();
      if (key !== undefined) {
        mSettings["key"] = key;
      }
      processAggregations(metadata, mSettings);
      const classDef = mSettings.class;
      const refDef = mSettings.ref;
      delete mSettings.ref;
      delete mSettings.class;
      processProperties(metadata, mSettings);
      targetControl = new ControlType(mSettings);
      if (classDef) {
        targetControl.addStyleClass(classDef);
      }
      if (refDef) {
        refDef.setCurrent(targetControl);
      }
    } else if (typeof ControlType === "function") {
      const controlTypeFn = ControlType;
      targetControl = controlTypeFn(mSettings);
    } else {
      targetControl = new Text({
        text: "Missing component " + ControlType
      });
    }
    return targetControl;
  };
  return jsxControl;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhZGRDaGlsZEFnZ3JlZ2F0aW9uIiwiYWdncmVnYXRpb25DaGlsZHJlbiIsImFnZ3JlZ2F0aW9uTmFtZSIsImNoaWxkIiwidW5kZWZpbmVkIiwiaXNDaGlsZEFuRWxlbWVudCIsInB1c2giLCJBcnJheSIsImlzQXJyYXkiLCJmb3JFYWNoIiwic3ViQ2hpbGQiLCJPYmplY3QiLCJrZXlzIiwiY2hpbGRLZXkiLCJjaGlsZHJlbiIsImlzQSIsImlzQUNvbnRyb2wiLCJnZXRNZXRhZGF0YSIsInByb2Nlc3NBZ2dyZWdhdGlvbnMiLCJtZXRhZGF0YSIsIm1TZXR0aW5ncyIsIm1ldGFkYXRhQWdncmVnYXRpb25zIiwiZ2V0QWxsQWdncmVnYXRpb25zIiwiZGVmYXVsdEFnZ3JlZ2F0aW9uTmFtZSIsImdldERlZmF1bHRBZ2dyZWdhdGlvbk5hbWUiLCJoYXNPd25Qcm9wZXJ0eSIsInRlbXBsYXRlIiwicHJvY2Vzc1Byb3BlcnRpZXMiLCJzZXR0aW5ncyIsInNldHRpbmdzS2V5IiwidmFsdWUiLCJfdHlwZSIsImJpbmRpbmdUb29sa2l0RXhwcmVzc2lvbiIsImlzQ29uc3RhbnQiLCJjb21waWxlQ29uc3RhbnQiLCJjb21waWxlRXhwcmVzc2lvbiIsInN0YXJ0c1dpdGgiLCJwcm9wZXJ0eVR5cGUiLCJnZXRBbGxQcm9wZXJ0aWVzIiwiZ2V0VHlwZSIsIkRhdGFUeXBlIiwiaW5kZXhPZiIsImdldE5hbWUiLCJwYXJzZVZhbHVlIiwianN4Q29udHJvbCIsIkNvbnRyb2xUeXBlIiwia2V5IiwianN4Q29udGV4dCIsInRhcmdldENvbnRyb2wiLCJpc0ZyYWdtZW50IiwiaXNSdW50aW1lIiwicnVudGltZUJ1aWxkaW5nQmxvY2siLCJnZXRDb250ZW50IiwidmlldyIsImFwcENvbXBvbmVudCIsImNsYXNzRGVmIiwiY2xhc3MiLCJyZWZEZWYiLCJyZWYiLCJhZGRTdHlsZUNsYXNzIiwic2V0Q3VycmVudCIsImNvbnRyb2xUeXBlRm4iLCJUZXh0IiwidGV4dCJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsianN4LWNvbnRyb2wudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJ1aWxkaW5nQmxvY2tCYXNlIGZyb20gXCJzYXAvZmUvY29yZS9idWlsZGluZ0Jsb2Nrcy9CdWlsZGluZ0Jsb2NrQmFzZVwiO1xuaW1wb3J0IHR5cGUgeyBCaW5kaW5nVG9vbGtpdEV4cHJlc3Npb24gfSBmcm9tIFwic2FwL2ZlL2NvcmUvaGVscGVycy9CaW5kaW5nVG9vbGtpdFwiO1xuaW1wb3J0IHsgY29tcGlsZUNvbnN0YW50LCBjb21waWxlRXhwcmVzc2lvbiwgaXNDb25zdGFudCB9IGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL0JpbmRpbmdUb29sa2l0XCI7XG5pbXBvcnQgdHlwZSB7IENvbnRyb2xQcm9wZXJ0aWVzLCBKU1hDb250ZXh0LCBOb25Db250cm9sUHJvcGVydGllcywgUmVmIH0gZnJvbSBcInNhcC9mZS9jb3JlL2pzeC1ydW50aW1lL2pzeFwiO1xuaW1wb3J0IFRleHQgZnJvbSBcInNhcC9tL1RleHRcIjtcbmltcG9ydCBEYXRhVHlwZSBmcm9tIFwic2FwL3VpL2Jhc2UvRGF0YVR5cGVcIjtcbmltcG9ydCB0eXBlIE1hbmFnZWRPYmplY3RNZXRhZGF0YSBmcm9tIFwic2FwL3VpL2Jhc2UvTWFuYWdlZE9iamVjdE1ldGFkYXRhXCI7XG5pbXBvcnQgdHlwZSBDb250cm9sIGZyb20gXCJzYXAvdWkvY29yZS9Db250cm9sXCI7XG5pbXBvcnQgdHlwZSB7ICRDb250cm9sU2V0dGluZ3MgfSBmcm9tIFwic2FwL3VpL2NvcmUvQ29udHJvbFwiO1xuaW1wb3J0IHR5cGUgRWxlbWVudCBmcm9tIFwic2FwL3VpL2NvcmUvRWxlbWVudFwiO1xuXG5jb25zdCBhZGRDaGlsZEFnZ3JlZ2F0aW9uID0gZnVuY3Rpb24gKGFnZ3JlZ2F0aW9uQ2hpbGRyZW46IGFueSwgYWdncmVnYXRpb25OYW1lOiBzdHJpbmcsIGNoaWxkOiBhbnkpIHtcblx0aWYgKGNoaWxkID09PSB1bmRlZmluZWQgfHwgdHlwZW9mIGNoaWxkID09PSBcInN0cmluZ1wiKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmICghYWdncmVnYXRpb25DaGlsZHJlblthZ2dyZWdhdGlvbk5hbWVdKSB7XG5cdFx0YWdncmVnYXRpb25DaGlsZHJlblthZ2dyZWdhdGlvbk5hbWVdID0gW107XG5cdH1cblx0aWYgKGlzQ2hpbGRBbkVsZW1lbnQoY2hpbGQpKSB7XG5cdFx0YWdncmVnYXRpb25DaGlsZHJlblthZ2dyZWdhdGlvbk5hbWVdLnB1c2goY2hpbGQpO1xuXHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY2hpbGQpKSB7XG5cdFx0Y2hpbGQuZm9yRWFjaCgoc3ViQ2hpbGQpID0+IHtcblx0XHRcdGFkZENoaWxkQWdncmVnYXRpb24oYWdncmVnYXRpb25DaGlsZHJlbiwgYWdncmVnYXRpb25OYW1lLCBzdWJDaGlsZCk7XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0T2JqZWN0LmtleXMoY2hpbGQpLmZvckVhY2goKGNoaWxkS2V5KSA9PiB7XG5cdFx0XHRhZGRDaGlsZEFnZ3JlZ2F0aW9uKGFnZ3JlZ2F0aW9uQ2hpbGRyZW4sIGNoaWxkS2V5LCBjaGlsZFtjaGlsZEtleV0pO1xuXHRcdH0pO1xuXHR9XG59O1xuY29uc3QgaXNDaGlsZEFuRWxlbWVudCA9IGZ1bmN0aW9uIDxUPihjaGlsZHJlbj86IEVsZW1lbnQgfCBDb250cm9sUHJvcGVydGllczxUPik6IGNoaWxkcmVuIGlzIEVsZW1lbnQge1xuXHRyZXR1cm4gKGNoaWxkcmVuIGFzIEVsZW1lbnQpPy5pc0E/LihcInNhcC51aS5jb3JlLkVsZW1lbnRcIik7XG59O1xuY29uc3QgaXNBQ29udHJvbCA9IGZ1bmN0aW9uIChjaGlsZHJlbj86IHR5cGVvZiBDb250cm9sIHwgRnVuY3Rpb24pOiBjaGlsZHJlbiBpcyB0eXBlb2YgQ29udHJvbCB7XG5cdHJldHVybiAhIShjaGlsZHJlbiBhcyB0eXBlb2YgQ29udHJvbCk/LmdldE1ldGFkYXRhO1xufTtcblxuZnVuY3Rpb24gcHJvY2Vzc0FnZ3JlZ2F0aW9ucyhtZXRhZGF0YTogTWFuYWdlZE9iamVjdE1ldGFkYXRhLCBtU2V0dGluZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4pIHtcblx0Y29uc3QgbWV0YWRhdGFBZ2dyZWdhdGlvbnMgPSBtZXRhZGF0YS5nZXRBbGxBZ2dyZWdhdGlvbnMoKSBhcyBhbnk7XG5cdGNvbnN0IGRlZmF1bHRBZ2dyZWdhdGlvbk5hbWUgPSBtZXRhZGF0YS5nZXREZWZhdWx0QWdncmVnYXRpb25OYW1lKCk7XG5cdGNvbnN0IGFnZ3JlZ2F0aW9uQ2hpbGRyZW46IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9O1xuXHRhZGRDaGlsZEFnZ3JlZ2F0aW9uKGFnZ3JlZ2F0aW9uQ2hpbGRyZW4sIGRlZmF1bHRBZ2dyZWdhdGlvbk5hbWUsIG1TZXR0aW5ncy5jaGlsZHJlbik7XG5cdGRlbGV0ZSBtU2V0dGluZ3MuY2hpbGRyZW47XG5cdC8vIGZpbmQgb3V0IHdoaWNoIGFnZ3JlZ2F0aW9uIGFyZSBib3VuZCAoYm90aCBpbiBjaGlsZHJlbiBhbmQgZGlyZWN0bHkgdW5kZXIgaXQpXG5cdE9iamVjdC5rZXlzKG1ldGFkYXRhQWdncmVnYXRpb25zKS5mb3JFYWNoKChhZ2dyZWdhdGlvbk5hbWUpID0+IHtcblx0XHRpZiAoYWdncmVnYXRpb25DaGlsZHJlblthZ2dyZWdhdGlvbk5hbWVdICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlmIChtU2V0dGluZ3MuaGFzT3duUHJvcGVydHkoYWdncmVnYXRpb25OYW1lKSkge1xuXHRcdFx0XHQvLyBhbHdheXMgdXNlIHRoZSBmaXJzdCBpdGVtIGFzIHRlbXBsYXRlIGFjY29yZGluZyB0byBVSTUgbG9naWNcblx0XHRcdFx0KG1TZXR0aW5ncyBhcyBhbnkpW2FnZ3JlZ2F0aW9uTmFtZV0udGVtcGxhdGUgPSBhZ2dyZWdhdGlvbkNoaWxkcmVuW2FnZ3JlZ2F0aW9uTmFtZV1bMF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQobVNldHRpbmdzIGFzIGFueSlbYWdncmVnYXRpb25OYW1lXSA9IGFnZ3JlZ2F0aW9uQ2hpbGRyZW5bYWdncmVnYXRpb25OYW1lXTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufVxuXG4vKipcbiAqIFByb2Nlc3NlcyB0aGUgcHJvcGVydGllcy5cbiAqXG4gKiBJZiB0aGUgcHJvcGVydHkgaXMgYSBiaW5kaW5nVG9vbGtpdCBleHByZXNzaW9uIHdlIG5lZWQgdG8gY29tcGlsZSBpdC5cbiAqIEVsc2UgaWYgdGhlIHByb3BlcnR5IGlzIHNldCBhcyBzdHJpbmcgKGNvbXBpbGVkIGJpbmRpbmcgZXhwcmVzc2lvbiByZXR1cm5zIHN0cmluZyBieSBkZWZhdWx0IGV2ZW4gaWYgaXQncyBhIGJvb2xlYW4sIGludCwgZXRjLikgYW5kIGl0IGRvZXNuJ3QgbWF0Y2ggd2l0aCBleHBlY3RlZFxuICogZm9ybWF0IHRoZSB2YWx1ZSBpcyBwYXJzZWQgdG8gcHJvdmlkZSBleHBlY3RlZCBmb3JtYXQuXG4gKlxuICogQHBhcmFtIG1ldGFkYXRhIE1ldGFkYXRhIG9mIHRoZSBjb250cm9sXG4gKiBAcGFyYW0gc2V0dGluZ3MgU2V0dGluZ3Mgb2YgdGhlIGNvbnRyb2xcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiBwcm9jZXNzUHJvcGVydGllcyhtZXRhZGF0YTogTWFuYWdlZE9iamVjdE1ldGFkYXRhLCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55Pikge1xuXHRsZXQgc2V0dGluZ3NLZXk6IGtleW9mIHR5cGVvZiBzZXR0aW5ncztcblx0Zm9yIChzZXR0aW5nc0tleSBpbiBzZXR0aW5ncykge1xuXHRcdGNvbnN0IHZhbHVlID0gc2V0dGluZ3Nbc2V0dGluZ3NLZXldO1xuXHRcdGlmICh2YWx1ZT8uX3R5cGUpIHtcblx0XHRcdGNvbnN0IGJpbmRpbmdUb29sa2l0RXhwcmVzc2lvbjogQmluZGluZ1Rvb2xraXRFeHByZXNzaW9uPGFueT4gPSB2YWx1ZTtcblx0XHRcdGlmIChpc0NvbnN0YW50KGJpbmRpbmdUb29sa2l0RXhwcmVzc2lvbikpIHtcblx0XHRcdFx0c2V0dGluZ3Nbc2V0dGluZ3NLZXldID0gY29tcGlsZUNvbnN0YW50KHZhbHVlLCBmYWxzZSwgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXR0aW5nc1tzZXR0aW5nc0tleV0gPSBjb21waWxlRXhwcmVzc2lvbihiaW5kaW5nVG9vbGtpdEV4cHJlc3Npb24pIGFzIGFueTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKHR5cGVvZiBzZXR0aW5nc1tzZXR0aW5nc0tleV0gPT09IFwic3RyaW5nXCIgJiYgIXNldHRpbmdzW3NldHRpbmdzS2V5XS5zdGFydHNXaXRoKFwie1wiKSkge1xuXHRcdFx0Y29uc3QgcHJvcGVydHlUeXBlID0gKG1ldGFkYXRhLmdldEFsbFByb3BlcnRpZXMoKVtzZXR0aW5nc0tleV0gYXMgYW55KT8uZ2V0VHlwZT8uKCk7XG5cdFx0XHRpZiAocHJvcGVydHlUeXBlICYmIHByb3BlcnR5VHlwZSBpbnN0YW5jZW9mIERhdGFUeXBlICYmIFtcImJvb2xlYW5cIiwgXCJpbnRcIiwgXCJmbG9hdFwiXS5pbmRleE9mKHByb3BlcnR5VHlwZS5nZXROYW1lKCkpID4gLTEpIHtcblx0XHRcdFx0c2V0dGluZ3Nbc2V0dGluZ3NLZXldID0gcHJvcGVydHlUeXBlLnBhcnNlVmFsdWUodmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5jb25zdCBqc3hDb250cm9sID0gZnVuY3Rpb24gPFQgZXh0ZW5kcyBFbGVtZW50Pihcblx0Q29udHJvbFR5cGU6IHR5cGVvZiBDb250cm9sIHwgRnVuY3Rpb24sXG5cdG1TZXR0aW5nczogTm9uQ29udHJvbFByb3BlcnRpZXM8VD4gJiB7IGtleTogc3RyaW5nOyBjaGlsZHJlbj86IEVsZW1lbnQgfCBDb250cm9sUHJvcGVydGllczxUPjsgcmVmPzogUmVmPFQ+OyBjbGFzcz86IHN0cmluZyB9LFxuXHRrZXk6IHN0cmluZyxcblx0anN4Q29udGV4dDogSlNYQ29udGV4dFxuKTogQ29udHJvbCB8IENvbnRyb2xbXSB7XG5cdGxldCB0YXJnZXRDb250cm9sO1xuXG5cdGlmICgoQ29udHJvbFR5cGUgYXMgYW55KT8uaXNGcmFnbWVudCkge1xuXHRcdHRhcmdldENvbnRyb2wgPSBtU2V0dGluZ3MuY2hpbGRyZW47XG5cdH0gZWxzZSBpZiAoKENvbnRyb2xUeXBlIGFzIHR5cGVvZiBCdWlsZGluZ0Jsb2NrQmFzZSk/LmlzUnVudGltZSkge1xuXHRcdGNvbnN0IHJ1bnRpbWVCdWlsZGluZ0Jsb2NrID0gbmV3IChDb250cm9sVHlwZSBhcyBhbnkpKG1TZXR0aW5ncyk7XG5cdFx0dGFyZ2V0Q29udHJvbCA9IHJ1bnRpbWVCdWlsZGluZ0Jsb2NrLmdldENvbnRlbnQoanN4Q29udGV4dC52aWV3LCBqc3hDb250ZXh0LmFwcENvbXBvbmVudCk7XG5cdH0gZWxzZSBpZiAoaXNBQ29udHJvbChDb250cm9sVHlwZSkpIHtcblx0XHRjb25zdCBtZXRhZGF0YSA9IENvbnRyb2xUeXBlLmdldE1ldGFkYXRhKCk7XG5cdFx0aWYgKGtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRtU2V0dGluZ3NbXCJrZXlcIl0gPSBrZXk7XG5cdFx0fVxuXHRcdHByb2Nlc3NBZ2dyZWdhdGlvbnMobWV0YWRhdGEsIG1TZXR0aW5ncyk7XG5cdFx0Y29uc3QgY2xhc3NEZWYgPSBtU2V0dGluZ3MuY2xhc3M7XG5cdFx0Y29uc3QgcmVmRGVmID0gbVNldHRpbmdzLnJlZjtcblx0XHRkZWxldGUgbVNldHRpbmdzLnJlZjtcblx0XHRkZWxldGUgbVNldHRpbmdzLmNsYXNzO1xuXHRcdHByb2Nlc3NQcm9wZXJ0aWVzKG1ldGFkYXRhLCBtU2V0dGluZ3MpO1xuXHRcdHRhcmdldENvbnRyb2wgPSBuZXcgQ29udHJvbFR5cGUobVNldHRpbmdzIGFzICRDb250cm9sU2V0dGluZ3MpO1xuXHRcdGlmIChjbGFzc0RlZikge1xuXHRcdFx0dGFyZ2V0Q29udHJvbC5hZGRTdHlsZUNsYXNzKGNsYXNzRGVmKTtcblx0XHR9XG5cdFx0aWYgKHJlZkRlZikge1xuXHRcdFx0cmVmRGVmLnNldEN1cnJlbnQodGFyZ2V0Q29udHJvbCBhcyBhbnkpO1xuXHRcdH1cblx0fSBlbHNlIGlmICh0eXBlb2YgQ29udHJvbFR5cGUgPT09IFwiZnVuY3Rpb25cIikge1xuXHRcdGNvbnN0IGNvbnRyb2xUeXBlRm4gPSBDb250cm9sVHlwZTtcblx0XHR0YXJnZXRDb250cm9sID0gY29udHJvbFR5cGVGbihtU2V0dGluZ3MgYXMgJENvbnRyb2xTZXR0aW5ncyk7XG5cdH0gZWxzZSB7XG5cdFx0dGFyZ2V0Q29udHJvbCA9IG5ldyBUZXh0KHsgdGV4dDogXCJNaXNzaW5nIGNvbXBvbmVudCBcIiArIChDb250cm9sVHlwZSBhcyBhbnkpIH0pO1xuXHR9XG5cblx0cmV0dXJuIHRhcmdldENvbnRyb2w7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBqc3hDb250cm9sO1xuIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQTtBQUFBOzs7Ozs7O0VBV0EsTUFBTUEsbUJBQW1CLEdBQUcsVUFBVUMsbUJBQXdCLEVBQUVDLGVBQXVCLEVBQUVDLEtBQVUsRUFBRTtJQUNwRyxJQUFJQSxLQUFLLEtBQUtDLFNBQVMsSUFBSSxPQUFPRCxLQUFLLEtBQUssUUFBUSxFQUFFO01BQ3JEO0lBQ0Q7SUFDQSxJQUFJLENBQUNGLG1CQUFtQixDQUFDQyxlQUFlLENBQUMsRUFBRTtNQUMxQ0QsbUJBQW1CLENBQUNDLGVBQWUsQ0FBQyxHQUFHLEVBQUU7SUFDMUM7SUFDQSxJQUFJRyxnQkFBZ0IsQ0FBQ0YsS0FBSyxDQUFDLEVBQUU7TUFDNUJGLG1CQUFtQixDQUFDQyxlQUFlLENBQUMsQ0FBQ0ksSUFBSSxDQUFDSCxLQUFLLENBQUM7SUFDakQsQ0FBQyxNQUFNLElBQUlJLEtBQUssQ0FBQ0MsT0FBTyxDQUFDTCxLQUFLLENBQUMsRUFBRTtNQUNoQ0EsS0FBSyxDQUFDTSxPQUFPLENBQUVDLFFBQVEsSUFBSztRQUMzQlYsbUJBQW1CLENBQUNDLG1CQUFtQixFQUFFQyxlQUFlLEVBQUVRLFFBQVEsQ0FBQztNQUNwRSxDQUFDLENBQUM7SUFD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