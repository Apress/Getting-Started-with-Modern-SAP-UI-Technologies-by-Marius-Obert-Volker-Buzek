/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/fe/core/ActionRuntime", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/helpers/DeleteHelper", "sap/fe/core/library", "sap/fe/macros/field/FieldRuntime", "sap/fe/macros/table/TableHelper"], function (Log, ActionRuntime, CommonUtils, BusyLocker, deleteHelper, FELibrary, FieldRuntime, TableHelper) {
  "use strict";

  const CreationMode = FELibrary.CreationMode;
  /**
   * Static class used by Table building block during runtime
   *
   * @private
   * @experimental This module is only for internal/experimental use!
   */
  const TableRuntime = {
    displayTableSettings: function (oEvent) {
      /*
      		 Temporary solution
      		 Wait for mdc Table to provide public api to either get button 'Settings' or fire event on this button
      		 */
      const oParent = oEvent.getSource().getParent(),
        oSettingsButton = sap.ui.getCore().byId(`${oParent.getId()}-settings`);
      CommonUtils.fireButtonPress(oSettingsButton);
    },
    executeConditionalActionShortcut: function (sButtonMatcher, oSource) {
      // Get the button related to keyboard shortcut
      const oMdcTable = oSource.getParent();
      if (sButtonMatcher !== CreationMode.CreationRow) {
        const oButton = oMdcTable.getActions().reduce(function (aActionButtons, oActionToolbarAction) {
          return aActionButtons.concat(oActionToolbarAction.getAction());
        }, []).find(function (oActionButton) {
          return oActionButton.getId().endsWith(sButtonMatcher);
        });
        CommonUtils.fireButtonPress(oButton);
      } else {
        const oCreationRow = oMdcTable.getAggregation("creationRow");
        if (oCreationRow && oCreationRow.getApplyEnabled() && oCreationRow.getVisible()) {
          oCreationRow.fireApply();
        }
      }
    },
    setContexts: function (oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath) {
      BusyLocker.lock(oTable);
      return TableRuntime.setContextsAsync(oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath).then(() => {
        Log.info("Selections updated");
      }).catch(error => {
        Log.error(error);
      }).finally(() => {
        BusyLocker.unlock(oTable);
      });
    },
    setContextsAsync: async function (oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath) {
      const aActionsMultiselectDisabled = sActionsMultiselectDisabled ? sActionsMultiselectDisabled.split(",") : [];
      const oActionOperationAvailableMap = JSON.parse(sCollection);
      const oNavigationAvailableMap = sNavigationAvailableMap && sNavigationAvailableMap !== "undefined" && JSON.parse(sNavigationAvailableMap);
      let aSelectedContexts = oTable.getSelectedContexts();
      const aDeletableContexts = [];
      const bReadOnlyDraftEnabled = oTable.data("displayModePropertyBinding") === "true" && draft !== "undefined";
      const aUpdatableContexts = [];
      // oDynamicActions are bound actions that are available according to some property
      // in each item
      const oDynamicActions = {};
      const oIBN = {};
      const oInternalModelContext = oTable.getBindingContext("internal");
      if (!oInternalModelContext) {
        return;
      }
      //do not consider empty rows as selected context
      aSelectedContexts = aSelectedContexts.filter(function (oContext) {
        return !oContext.isInactive();
      });
      const oModelObject = Object.assign(oInternalModelContext.getObject() || {}, {
        selectedContexts: aSelectedContexts,
        numberOfSelectedContexts: aSelectedContexts.length,
        dynamicActions: oDynamicActions,
        ibn: oIBN,
        deleteEnabled: true,
        deletableContexts: aDeletableContexts,
        unSavedContexts: [],
        lockedContexts: [],
        draftsWithNonDeletableActive: [],
        draftsWithDeletableActive: [],
        createModeContexts: [],
        controlId: "",
        updatableContexts: aUpdatableContexts,
        semanticKeyHasDraftIndicator: oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") ? oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") : undefined
      });
      for (const oSelectedContext of aSelectedContexts) {
        const oContextData = oSelectedContext.getObject();
        for (const key in oContextData) {
          if (key.indexOf("#") === 0) {
            let sActionPath = key;
            sActionPath = sActionPath.substring(1, sActionPath.length);
            oModelObject.dynamicActions[sActionPath] = {
              enabled: true
            };
            oInternalModelContext.setProperty("", oModelObject);
          }
        }
        // The updatable contexts with mass edit depend on the following:
        // 1. Update is dependendent on current entity property (sUpdatablePath).
        // 2. The table is read only and draft enabled(like LR), in this case only active contexts can be mass edited(not draft contexts).
        //    So, update depends on 'IsActiveEntity' value which needs to be checked.
        const bUpdatableByPath = sUpdatablePath.length === 0 || !!oSelectedContext.getProperty(sUpdatablePath);
        const bNotDraftInReadOnlyMode = !bReadOnlyDraftEnabled || oContextData.IsActiveEntity;
        if (bUpdatableByPath && bNotDraftInReadOnlyMode) {
          aUpdatableContexts.push(oSelectedContext);
        }
      }
      deleteHelper.updateDeleteInfoForSelectedContexts(oInternalModelContext, aSelectedContexts);
      if (!oTable.data("enableAnalytics")) {
        TableHelper.setIBNEnablement(oInternalModelContext, oNavigationAvailableMap, aSelectedContexts);
      }
      if (aSelectedContexts.length > 1) {
        this.disableAction(aActionsMultiselectDisabled, oDynamicActions);
      }
      if (oModelObject) {
        oModelObject["updatableContexts"] = aUpdatableContexts;
        oModelObject["controlId"] = oTable.getId();
        oInternalModelContext.setProperty("", oModelObject);
      }
      return ActionRuntime.setActionEnablement(oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, "table");
    },
    disableAction: function (aActionsMultiselectDisabled, oDynamicActions) {
      aActionsMultiselectDisabled.forEach(function (sAction) {
        oDynamicActions[sAction] = {
          bEnabled: false
        };
      });
    },
    onFieldChangeInCreationRow: function (oEvent, oCustomValidationFunction) {
      // CREATION ROW CASE
      const mField = FieldRuntime.getFieldStateOnChange(oEvent),
        oSourceField = mField.field,
        sFieldId = oSourceField.getId();
      const oInternalModelContext = oSourceField.getBindingContext("internal"),
        mFieldValidity = oInternalModelContext.getProperty("creationRowFieldValidity"),
        mNewFieldValidity = Object.assign({}, mFieldValidity);
      mNewFieldValidity[sFieldId] = mField.state;
      oInternalModelContext.setProperty("creationRowFieldValidity", mNewFieldValidity);

      // prepare Custom Validation
      if (oCustomValidationFunction) {
        const mCustomValidity = oInternalModelContext.getProperty("creationRowCustomValidity"),
          mNewCustomValidity = Object.assign({}, mCustomValidity);
        mNewCustomValidity[oSourceField.getBinding("value").getPath()] = {
          fieldId: oSourceField.getId()
        };
        oInternalModelContext.setProperty("creationRowCustomValidity", mNewCustomValidity);
        // Remove existing CustomValidation message
        const oMessageManager = sap.ui.getCore().getMessageManager();
        const sTarget = `${oSourceField.getBindingContext().getPath()}/${oSourceField.getBindingPath("value")}`;
        oMessageManager.getMessageModel().getData().forEach(function (oMessage) {
          if (oMessage.target === sTarget) {
            oMessageManager.removeMessages(oMessage);
          }
        });
      }
    }
  };
  return TableRuntime;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDcmVhdGlvbk1vZGUiLCJGRUxpYnJhcnkiLCJUYWJsZVJ1bnRpbWUiLCJkaXNwbGF5VGFibGVTZXR0aW5ncyIsIm9FdmVudCIsIm9QYXJlbnQiLCJnZXRTb3VyY2UiLCJnZXRQYXJlbnQiLCJvU2V0dGluZ3NCdXR0b24iLCJzYXAiLCJ1aSIsImdldENvcmUiLCJieUlkIiwiZ2V0SWQiLCJDb21tb25VdGlscyIsImZpcmVCdXR0b25QcmVzcyIsImV4ZWN1dGVDb25kaXRpb25hbEFjdGlvblNob3J0Y3V0Iiwic0J1dHRvbk1hdGNoZXIiLCJvU291cmNlIiwib01kY1RhYmxlIiwiQ3JlYXRpb25Sb3ciLCJvQnV0dG9uIiwiZ2V0QWN0aW9ucyIsInJlZHVjZSIsImFBY3Rpb25CdXR0b25zIiwib0FjdGlvblRvb2xiYXJBY3Rpb24iLCJjb25jYXQiLCJnZXRBY3Rpb24iLCJmaW5kIiwib0FjdGlvbkJ1dHRvbiIsImVuZHNXaXRoIiwib0NyZWF0aW9uUm93IiwiZ2V0QWdncmVnYXRpb24iLCJnZXRBcHBseUVuYWJsZWQiLCJnZXRWaXNpYmxlIiwiZmlyZUFwcGx5Iiwic2V0Q29udGV4dHMiLCJvVGFibGUiLCJzRGVsZXRhYmxlUGF0aCIsImRyYWZ0Iiwic0NvbGxlY3Rpb24iLCJzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCIsInNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCIsInNVcGRhdGFibGVQYXRoIiwiQnVzeUxvY2tlciIsImxvY2siLCJzZXRDb250ZXh0c0FzeW5jIiwidGhlbiIsIkxvZyIsImluZm8iLCJjYXRjaCIsImVycm9yIiwiZmluYWxseSIsInVubG9jayIsImFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCIsInNwbGl0Iiwib0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCIsIkpTT04iLCJwYXJzZSIsIm9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwIiwiYVNlbGVjdGVkQ29udGV4dHMiLCJnZXRTZWxlY3RlZENvbnRleHRzIiwiYURlbGV0YWJsZUNvbnRleHRzIiwiYlJlYWRPbmx5RHJhZnRFbmFibGVkIiwiZGF0YSIsImFVcGRhdGFibGVDb250ZXh0cyIsIm9EeW5hbWljQWN0aW9ucyIsIm9JQk4iLCJvSW50ZXJuYWxNb2RlbENvbnRleHQiLCJnZXRCaW5kaW5nQ29udGV4dCIsImZpbHRlciIsIm9Db250ZXh0IiwiaXNJbmFjdGl2ZSIsIm9Nb2RlbE9iamVjdCIsIk9iamVjdCIsImFzc2lnbiIsImdldE9iamVjdCIsInNlbGVjdGVkQ29udGV4dHMiLCJudW1iZXJPZlNlbGVjdGVkQ29udGV4dHMiLCJsZW5ndGgiLCJkeW5hbWljQWN0aW9ucyIsImlibiIsImRlbGV0ZUVuYWJsZWQiLCJkZWxldGFibGVDb250ZXh0cyIsInVuU2F2ZWRDb250ZXh0cyIsImxvY2tlZENvbnRleHRzIiwiZHJhZnRzV2l0aE5vbkRlbGV0YWJsZUFjdGl2ZSIsImRyYWZ0c1dpdGhEZWxldGFibGVBY3RpdmUiLCJjcmVhdGVNb2RlQ29udGV4dHMiLCJjb250cm9sSWQiLCJ1cGRhdGFibGVDb250ZXh0cyIsInNlbWFudGljS2V5SGFzRHJhZnRJbmRpY2F0b3IiLCJnZXRQcm9wZXJ0eSIsInVuZGVmaW5lZCIsIm9TZWxlY3RlZENvbnRleHQiLCJvQ29udGV4dERhdGEiLCJrZXkiLCJpbmRleE9mIiwic0FjdGlvblBhdGgiLCJzdWJzdHJpbmciLCJlbmFibGVkIiwic2V0UHJvcGVydHkiLCJiVXBkYXRhYmxlQnlQYXRoIiwiYk5vdERyYWZ0SW5SZWFkT25seU1vZGUiLCJJc0FjdGl2ZUVudGl0eSIsInB1c2giLCJkZWxldGVIZWxwZXIiLCJ1cGRhdGVEZWxldGVJbmZvRm9yU2VsZWN0ZWRDb250ZXh0cyIsIlRhYmxlSGVscGVyIiwic2V0SUJORW5hYmxlbWVudCIsImRpc2FibGVBY3Rpb24iLCJBY3Rpb25SdW50aW1lIiwic2V0QWN0aW9uRW5hYmxlbWVudCIsImZvckVhY2giLCJzQWN0aW9uIiwiYkVuYWJsZWQiLCJvbkZpZWxkQ2hhbmdlSW5DcmVhdGlvblJvdyIsIm9DdXN0b21WYWxpZGF0aW9uRnVuY3Rpb24iLCJtRmllbGQiLCJGaWVsZFJ1bnRpbWUiLCJnZXRGaWVsZFN0YXRlT25DaGFuZ2UiLCJvU291cmNlRmllbGQiLCJmaWVsZCIsInNGaWVsZElkIiwibUZpZWxkVmFsaWRpdHkiLCJtTmV3RmllbGRWYWxpZGl0eSIsInN0YXRlIiwibUN1c3RvbVZhbGlkaXR5IiwibU5ld0N1c3RvbVZhbGlkaXR5IiwiZ2V0QmluZGluZyIsImdldFBhdGgiLCJmaWVsZElkIiwib01lc3NhZ2VNYW5hZ2VyIiwiZ2V0TWVzc2FnZU1hbmFnZXIiLCJzVGFyZ2V0IiwiZ2V0QmluZGluZ1BhdGgiLCJnZXRNZXNzYWdlTW9kZWwiLCJnZXREYXRhIiwib01lc3NhZ2UiLCJ0YXJnZXQiLCJyZW1vdmVNZXNzYWdlcyJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiVGFibGVSdW50aW1lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IEFjdGlvblJ1bnRpbWUgZnJvbSBcInNhcC9mZS9jb3JlL0FjdGlvblJ1bnRpbWVcIjtcbmltcG9ydCBDb21tb25VdGlscyBmcm9tIFwic2FwL2ZlL2NvcmUvQ29tbW9uVXRpbHNcIjtcbmltcG9ydCBCdXN5TG9ja2VyIGZyb20gXCJzYXAvZmUvY29yZS9jb250cm9sbGVyZXh0ZW5zaW9ucy9CdXN5TG9ja2VyXCI7XG5pbXBvcnQgZGVsZXRlSGVscGVyIGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL0RlbGV0ZUhlbHBlclwiO1xuaW1wb3J0IHR5cGUgeyBJbnRlcm5hbE1vZGVsQ29udGV4dCB9IGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL01vZGVsSGVscGVyXCI7XG5pbXBvcnQgRkVMaWJyYXJ5IGZyb20gXCJzYXAvZmUvY29yZS9saWJyYXJ5XCI7XG5pbXBvcnQgRmllbGRSdW50aW1lIGZyb20gXCJzYXAvZmUvbWFjcm9zL2ZpZWxkL0ZpZWxkUnVudGltZVwiO1xuaW1wb3J0IFRhYmxlSGVscGVyIGZyb20gXCJzYXAvZmUvbWFjcm9zL3RhYmxlL1RhYmxlSGVscGVyXCI7XG5pbXBvcnQgQnV0dG9uIGZyb20gXCJzYXAvbS9CdXR0b25cIjtcbmltcG9ydCB0eXBlIFRhYmxlIGZyb20gXCJzYXAvdWkvbWRjL1RhYmxlXCI7XG5pbXBvcnQgQ29udGV4dCBmcm9tIFwic2FwL3VpL21vZGVsL29kYXRhL3Y0L0NvbnRleHRcIjtcblxuY29uc3QgQ3JlYXRpb25Nb2RlID0gRkVMaWJyYXJ5LkNyZWF0aW9uTW9kZTtcbi8qKlxuICogU3RhdGljIGNsYXNzIHVzZWQgYnkgVGFibGUgYnVpbGRpbmcgYmxvY2sgZHVyaW5nIHJ1bnRpbWVcbiAqXG4gKiBAcHJpdmF0ZVxuICogQGV4cGVyaW1lbnRhbCBUaGlzIG1vZHVsZSBpcyBvbmx5IGZvciBpbnRlcm5hbC9leHBlcmltZW50YWwgdXNlIVxuICovXG5jb25zdCBUYWJsZVJ1bnRpbWUgPSB7XG5cdGRpc3BsYXlUYWJsZVNldHRpbmdzOiBmdW5jdGlvbiAob0V2ZW50OiBhbnkpIHtcblx0XHQvKlxuXHRcdFx0XHQgVGVtcG9yYXJ5IHNvbHV0aW9uXG5cdFx0XHRcdCBXYWl0IGZvciBtZGMgVGFibGUgdG8gcHJvdmlkZSBwdWJsaWMgYXBpIHRvIGVpdGhlciBnZXQgYnV0dG9uICdTZXR0aW5ncycgb3IgZmlyZSBldmVudCBvbiB0aGlzIGJ1dHRvblxuXHRcdFx0XHQgKi9cblx0XHRjb25zdCBvUGFyZW50ID0gb0V2ZW50LmdldFNvdXJjZSgpLmdldFBhcmVudCgpLFxuXHRcdFx0b1NldHRpbmdzQnV0dG9uID0gc2FwLnVpLmdldENvcmUoKS5ieUlkKGAke29QYXJlbnQuZ2V0SWQoKX0tc2V0dGluZ3NgKTtcblx0XHRDb21tb25VdGlscy5maXJlQnV0dG9uUHJlc3Mob1NldHRpbmdzQnV0dG9uIGFzIEJ1dHRvbik7XG5cdH0sXG5cdGV4ZWN1dGVDb25kaXRpb25hbEFjdGlvblNob3J0Y3V0OiBmdW5jdGlvbiAoc0J1dHRvbk1hdGNoZXI6IGFueSwgb1NvdXJjZTogYW55KSB7XG5cdFx0Ly8gR2V0IHRoZSBidXR0b24gcmVsYXRlZCB0byBrZXlib2FyZCBzaG9ydGN1dFxuXHRcdGNvbnN0IG9NZGNUYWJsZSA9IG9Tb3VyY2UuZ2V0UGFyZW50KCk7XG5cdFx0aWYgKHNCdXR0b25NYXRjaGVyICE9PSBDcmVhdGlvbk1vZGUuQ3JlYXRpb25Sb3cpIHtcblx0XHRcdGNvbnN0IG9CdXR0b24gPSBvTWRjVGFibGVcblx0XHRcdFx0LmdldEFjdGlvbnMoKVxuXHRcdFx0XHQucmVkdWNlKGZ1bmN0aW9uIChhQWN0aW9uQnV0dG9uczogYW55LCBvQWN0aW9uVG9vbGJhckFjdGlvbjogYW55KSB7XG5cdFx0XHRcdFx0cmV0dXJuIGFBY3Rpb25CdXR0b25zLmNvbmNhdChvQWN0aW9uVG9vbGJhckFjdGlvbi5nZXRBY3Rpb24oKSk7XG5cdFx0XHRcdH0sIFtdKVxuXHRcdFx0XHQuZmluZChmdW5jdGlvbiAob0FjdGlvbkJ1dHRvbjogYW55KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9BY3Rpb25CdXR0b24uZ2V0SWQoKS5lbmRzV2l0aChzQnV0dG9uTWF0Y2hlcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0Q29tbW9uVXRpbHMuZmlyZUJ1dHRvblByZXNzKG9CdXR0b24pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBvQ3JlYXRpb25Sb3cgPSBvTWRjVGFibGUuZ2V0QWdncmVnYXRpb24oXCJjcmVhdGlvblJvd1wiKTtcblx0XHRcdGlmIChvQ3JlYXRpb25Sb3cgJiYgb0NyZWF0aW9uUm93LmdldEFwcGx5RW5hYmxlZCgpICYmIG9DcmVhdGlvblJvdy5nZXRWaXNpYmxlKCkpIHtcblx0XHRcdFx0b0NyZWF0aW9uUm93LmZpcmVBcHBseSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRzZXRDb250ZXh0czogZnVuY3Rpb24gKFxuXHRcdG9UYWJsZTogVGFibGUsXG5cdFx0c0RlbGV0YWJsZVBhdGg6IHN0cmluZyxcblx0XHRkcmFmdDogc3RyaW5nLFxuXHRcdHNDb2xsZWN0aW9uOiBzdHJpbmcsXG5cdFx0c05hdmlnYXRpb25BdmFpbGFibGVNYXA6IHN0cmluZyxcblx0XHRzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQ6IHN0cmluZyxcblx0XHRzVXBkYXRhYmxlUGF0aDogc3RyaW5nXG5cdCkge1xuXHRcdEJ1c3lMb2NrZXIubG9jayhvVGFibGUpO1xuXHRcdHJldHVybiBUYWJsZVJ1bnRpbWUuc2V0Q29udGV4dHNBc3luYyhcblx0XHRcdG9UYWJsZSxcblx0XHRcdHNEZWxldGFibGVQYXRoLFxuXHRcdFx0ZHJhZnQsXG5cdFx0XHRzQ29sbGVjdGlvbixcblx0XHRcdHNOYXZpZ2F0aW9uQXZhaWxhYmxlTWFwLFxuXHRcdFx0c0FjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkLFxuXHRcdFx0c1VwZGF0YWJsZVBhdGhcblx0XHQpXG5cdFx0XHQudGhlbigoKSA9PiB7XG5cdFx0XHRcdExvZy5pbmZvKFwiU2VsZWN0aW9ucyB1cGRhdGVkXCIpO1xuXHRcdFx0fSlcblx0XHRcdC5jYXRjaCgoZXJyb3IpID0+IHtcblx0XHRcdFx0TG9nLmVycm9yKGVycm9yKTtcblx0XHRcdH0pXG5cdFx0XHQuZmluYWxseSgoKSA9PiB7XG5cdFx0XHRcdEJ1c3lMb2NrZXIudW5sb2NrKG9UYWJsZSk7XG5cdFx0XHR9KTtcblx0fSxcblxuXHRzZXRDb250ZXh0c0FzeW5jOiBhc3luYyBmdW5jdGlvbiAoXG5cdFx0b1RhYmxlOiBUYWJsZSxcblx0XHRzRGVsZXRhYmxlUGF0aDogc3RyaW5nLFxuXHRcdGRyYWZ0OiBzdHJpbmcsXG5cdFx0c0NvbGxlY3Rpb246IHN0cmluZyxcblx0XHRzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcDogc3RyaW5nLFxuXHRcdHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZDogc3RyaW5nLFxuXHRcdHNVcGRhdGFibGVQYXRoOiBzdHJpbmdcblx0KTogUHJvbWlzZTx2b2lkW10gfCB1bmRlZmluZWQ+IHtcblx0XHRjb25zdCBhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQgPSBzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQgPyBzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQuc3BsaXQoXCIsXCIpIDogW107XG5cdFx0Y29uc3Qgb0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCA9IEpTT04ucGFyc2Uoc0NvbGxlY3Rpb24pO1xuXHRcdGNvbnN0IG9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwID1cblx0XHRcdHNOYXZpZ2F0aW9uQXZhaWxhYmxlTWFwICYmIHNOYXZpZ2F0aW9uQXZhaWxhYmxlTWFwICE9PSBcInVuZGVmaW5lZFwiICYmIEpTT04ucGFyc2Uoc05hdmlnYXRpb25BdmFpbGFibGVNYXApO1xuXHRcdGxldCBhU2VsZWN0ZWRDb250ZXh0cyA9IG9UYWJsZS5nZXRTZWxlY3RlZENvbnRleHRzKCkgYXMgQ29udGV4dFtdO1xuXHRcdGNvbnN0IGFEZWxldGFibGVDb250ZXh0czogQ29udGV4dFtdID0gW107XG5cdFx0Y29uc3QgYlJlYWRPbmx5RHJhZnRFbmFibGVkID0gb1RhYmxlLmRhdGEoXCJkaXNwbGF5TW9kZVByb3BlcnR5QmluZGluZ1wiKSA9PT0gXCJ0cnVlXCIgJiYgZHJhZnQgIT09IFwidW5kZWZpbmVkXCI7XG5cdFx0Y29uc3QgYVVwZGF0YWJsZUNvbnRleHRzOiBDb250ZXh0W10gPSBbXTtcblx0XHQvLyBvRHluYW1pY0FjdGlvbnMgYXJlIGJvdW5kIGFjdGlvbnMgdGhhdCBhcmUgYXZhaWxhYmxlIGFjY29yZGluZyB0byBzb21lIHByb3BlcnR5XG5cdFx0Ly8gaW4gZWFjaCBpdGVtXG5cdFx0Y29uc3Qgb0R5bmFtaWNBY3Rpb25zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IHVuZGVmaW5lZCA9IHt9O1xuXHRcdGNvbnN0IG9JQk4gPSB7fTtcblx0XHRjb25zdCBvSW50ZXJuYWxNb2RlbENvbnRleHQgPSBvVGFibGUuZ2V0QmluZGluZ0NvbnRleHQoXCJpbnRlcm5hbFwiKSBhcyBJbnRlcm5hbE1vZGVsQ29udGV4dDtcblxuXHRcdGlmICghb0ludGVybmFsTW9kZWxDb250ZXh0KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdC8vZG8gbm90IGNvbnNpZGVyIGVtcHR5IHJvd3MgYXMgc2VsZWN0ZWQgY29udGV4dFxuXHRcdGFTZWxlY3RlZENvbnRleHRzID0gYVNlbGVjdGVkQ29udGV4dHMuZmlsdGVyKGZ1bmN0aW9uIChvQ29udGV4dDogQ29udGV4dCkge1xuXHRcdFx0cmV0dXJuICFvQ29udGV4dC5pc0luYWN0aXZlKCk7XG5cdFx0fSk7XG5cblx0XHRjb25zdCBvTW9kZWxPYmplY3QgPSBPYmplY3QuYXNzaWduKG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRPYmplY3QoKSB8fCB7fSwge1xuXHRcdFx0c2VsZWN0ZWRDb250ZXh0czogYVNlbGVjdGVkQ29udGV4dHMsXG5cdFx0XHRudW1iZXJPZlNlbGVjdGVkQ29udGV4dHM6IGFTZWxlY3RlZENvbnRleHRzLmxlbmd0aCxcblx0XHRcdGR5bmFtaWNBY3Rpb25zOiBvRHluYW1pY0FjdGlvbnMsXG5cdFx0XHRpYm46IG9JQk4sXG5cdFx0XHRkZWxldGVFbmFibGVkOiB0cnVlLFxuXHRcdFx0ZGVsZXRhYmxlQ29udGV4dHM6IGFEZWxldGFibGVDb250ZXh0cyxcblx0XHRcdHVuU2F2ZWRDb250ZXh0czogW10sXG5cdFx0XHRsb2NrZWRDb250ZXh0czogW10sXG5cdFx0XHRkcmFmdHNXaXRoTm9uRGVsZXRhYmxlQWN0aXZlOiBbXSxcblx0XHRcdGRyYWZ0c1dpdGhEZWxldGFibGVBY3RpdmU6IFtdLFxuXHRcdFx0Y3JlYXRlTW9kZUNvbnRleHRzOiBbXSxcblx0XHRcdGNvbnRyb2xJZDogXCJcIixcblx0XHRcdHVwZGF0YWJsZUNvbnRleHRzOiBhVXBkYXRhYmxlQ29udGV4dHMsXG5cdFx0XHRzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yOiBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yXCIpXG5cdFx0XHRcdD8gb0ludGVybmFsTW9kZWxDb250ZXh0LmdldFByb3BlcnR5KFwic2VtYW50aWNLZXlIYXNEcmFmdEluZGljYXRvclwiKVxuXHRcdFx0XHQ6IHVuZGVmaW5lZFxuXHRcdH0pO1xuXG5cdFx0Zm9yIChjb25zdCBvU2VsZWN0ZWRDb250ZXh0IG9mIGFTZWxlY3RlZENvbnRleHRzKSB7XG5cdFx0XHRjb25zdCBvQ29udGV4dERhdGEgPSBvU2VsZWN0ZWRDb250ZXh0LmdldE9iamVjdCgpO1xuXHRcdFx0Zm9yIChjb25zdCBrZXkgaW4gb0NvbnRleHREYXRhKSB7XG5cdFx0XHRcdGlmIChrZXkuaW5kZXhPZihcIiNcIikgPT09IDApIHtcblx0XHRcdFx0XHRsZXQgc0FjdGlvblBhdGg6IHN0cmluZyA9IGtleTtcblx0XHRcdFx0XHRzQWN0aW9uUGF0aCA9IHNBY3Rpb25QYXRoLnN1YnN0cmluZygxLCBzQWN0aW9uUGF0aC5sZW5ndGgpO1xuXHRcdFx0XHRcdG9Nb2RlbE9iamVjdC5keW5hbWljQWN0aW9uc1tzQWN0aW9uUGF0aF0gPSB7IGVuYWJsZWQ6IHRydWUgfTtcblx0XHRcdFx0XHRvSW50ZXJuYWxNb2RlbENvbnRleHQuc2V0UHJvcGVydHkoXCJcIiwgb01vZGVsT2JqZWN0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly8gVGhlIHVwZGF0YWJsZSBjb250ZXh0cyB3aXRoIG1hc3MgZWRpdCBkZXBlbmQgb24gdGhlIGZvbGxvd2luZzpcblx0XHRcdC8vIDEuIFVwZGF0ZSBpcyBkZXBlbmRlbmRlbnQgb24gY3VycmVudCBlbnRpdHkgcHJvcGVydHkgKHNVcGRhdGFibGVQYXRoKS5cblx0XHRcdC8vIDIuIFRoZSB0YWJsZSBpcyByZWFkIG9ubHkgYW5kIGRyYWZ0IGVuYWJsZWQobGlrZSBMUiksIGluIHRoaXMgY2FzZSBvbmx5IGFjdGl2ZSBjb250ZXh0cyBjYW4gYmUgbWFzcyBlZGl0ZWQobm90IGRyYWZ0IGNvbnRleHRzKS5cblx0XHRcdC8vICAgIFNvLCB1cGRhdGUgZGVwZW5kcyBvbiAnSXNBY3RpdmVFbnRpdHknIHZhbHVlIHdoaWNoIG5lZWRzIHRvIGJlIGNoZWNrZWQuXG5cdFx0XHRjb25zdCBiVXBkYXRhYmxlQnlQYXRoID0gc1VwZGF0YWJsZVBhdGgubGVuZ3RoID09PSAwIHx8ICEhb1NlbGVjdGVkQ29udGV4dC5nZXRQcm9wZXJ0eShzVXBkYXRhYmxlUGF0aCk7XG5cdFx0XHRjb25zdCBiTm90RHJhZnRJblJlYWRPbmx5TW9kZSA9ICFiUmVhZE9ubHlEcmFmdEVuYWJsZWQgfHwgb0NvbnRleHREYXRhLklzQWN0aXZlRW50aXR5O1xuXHRcdFx0aWYgKGJVcGRhdGFibGVCeVBhdGggJiYgYk5vdERyYWZ0SW5SZWFkT25seU1vZGUpIHtcblx0XHRcdFx0YVVwZGF0YWJsZUNvbnRleHRzLnB1c2gob1NlbGVjdGVkQ29udGV4dCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZGVsZXRlSGVscGVyLnVwZGF0ZURlbGV0ZUluZm9Gb3JTZWxlY3RlZENvbnRleHRzKG9JbnRlcm5hbE1vZGVsQ29udGV4dCwgYVNlbGVjdGVkQ29udGV4dHMpO1xuXG5cdFx0aWYgKCFvVGFibGUuZGF0YShcImVuYWJsZUFuYWx5dGljc1wiKSkge1xuXHRcdFx0VGFibGVIZWxwZXIuc2V0SUJORW5hYmxlbWVudChvSW50ZXJuYWxNb2RlbENvbnRleHQsIG9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwLCBhU2VsZWN0ZWRDb250ZXh0cyk7XG5cdFx0fVxuXG5cdFx0aWYgKGFTZWxlY3RlZENvbnRleHRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdHRoaXMuZGlzYWJsZUFjdGlvbihhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQsIG9EeW5hbWljQWN0aW9ucyk7XG5cdFx0fVxuXG5cdFx0aWYgKG9Nb2RlbE9iamVjdCkge1xuXHRcdFx0b01vZGVsT2JqZWN0W1widXBkYXRhYmxlQ29udGV4dHNcIl0gPSBhVXBkYXRhYmxlQ29udGV4dHM7XG5cdFx0XHRvTW9kZWxPYmplY3RbXCJjb250cm9sSWRcIl0gPSBvVGFibGUuZ2V0SWQoKTtcblx0XHRcdG9JbnRlcm5hbE1vZGVsQ29udGV4dC5zZXRQcm9wZXJ0eShcIlwiLCBvTW9kZWxPYmplY3QpO1xuXHRcdH1cblxuXHRcdHJldHVybiBBY3Rpb25SdW50aW1lLnNldEFjdGlvbkVuYWJsZW1lbnQob0ludGVybmFsTW9kZWxDb250ZXh0LCBvQWN0aW9uT3BlcmF0aW9uQXZhaWxhYmxlTWFwLCBhU2VsZWN0ZWRDb250ZXh0cywgXCJ0YWJsZVwiKTtcblx0fSxcblxuXHRkaXNhYmxlQWN0aW9uOiBmdW5jdGlvbiAoYUFjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkOiBhbnksIG9EeW5hbWljQWN0aW9uczogYW55KSB7XG5cdFx0YUFjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkLmZvckVhY2goZnVuY3Rpb24gKHNBY3Rpb246IGFueSkge1xuXHRcdFx0b0R5bmFtaWNBY3Rpb25zW3NBY3Rpb25dID0geyBiRW5hYmxlZDogZmFsc2UgfTtcblx0XHR9KTtcblx0fSxcblx0b25GaWVsZENoYW5nZUluQ3JlYXRpb25Sb3c6IGZ1bmN0aW9uIChvRXZlbnQ6IGFueSwgb0N1c3RvbVZhbGlkYXRpb25GdW5jdGlvbjogYW55KSB7XG5cdFx0Ly8gQ1JFQVRJT04gUk9XIENBU0Vcblx0XHRjb25zdCBtRmllbGQgPSBGaWVsZFJ1bnRpbWUuZ2V0RmllbGRTdGF0ZU9uQ2hhbmdlKG9FdmVudCksXG5cdFx0XHRvU291cmNlRmllbGQgPSBtRmllbGQuZmllbGQsXG5cdFx0XHRzRmllbGRJZCA9IG9Tb3VyY2VGaWVsZC5nZXRJZCgpO1xuXG5cdFx0Y29uc3Qgb0ludGVybmFsTW9kZWxDb250ZXh0ID0gb1NvdXJjZUZpZWxkLmdldEJpbmRpbmdDb250ZXh0KFwiaW50ZXJuYWxcIiksXG5cdFx0XHRtRmllbGRWYWxpZGl0eSA9IG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRQcm9wZXJ0eShcImNyZWF0aW9uUm93RmllbGRWYWxpZGl0eVwiKSxcblx0XHRcdG1OZXdGaWVsZFZhbGlkaXR5ID0gT2JqZWN0LmFzc2lnbih7fSwgbUZpZWxkVmFsaWRpdHkpO1xuXG5cdFx0bU5ld0ZpZWxkVmFsaWRpdHlbc0ZpZWxkSWRdID0gbUZpZWxkLnN0YXRlO1xuXHRcdG9JbnRlcm5hbE1vZGVsQ29udGV4dC5zZXRQcm9wZXJ0eShcImNyZWF0aW9uUm93RmllbGRWYWxpZGl0eVwiLCBtTmV3RmllbGRWYWxpZGl0eSk7XG5cblx0XHQvLyBwcmVwYXJlIEN1c3RvbSBWYWxpZGF0aW9uXG5cdFx0aWYgKG9DdXN0b21WYWxpZGF0aW9uRnVuY3Rpb24pIHtcblx0XHRcdGNvbnN0IG1DdXN0b21WYWxpZGl0eSA9IG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRQcm9wZXJ0eShcImNyZWF0aW9uUm93Q3VzdG9tVmFsaWRpdHlcIiksXG5cdFx0XHRcdG1OZXdDdXN0b21WYWxpZGl0eSA9IE9iamVjdC5hc3NpZ24oe30sIG1DdXN0b21WYWxpZGl0eSk7XG5cdFx0XHRtTmV3Q3VzdG9tVmFsaWRpdHlbb1NvdXJjZUZpZWxkLmdldEJpbmRpbmcoXCJ2YWx1ZVwiKS5nZXRQYXRoKCldID0ge1xuXHRcdFx0XHRmaWVsZElkOiBvU291cmNlRmllbGQuZ2V0SWQoKVxuXHRcdFx0fTtcblx0XHRcdG9JbnRlcm5hbE1vZGVsQ29udGV4dC5zZXRQcm9wZXJ0eShcImNyZWF0aW9uUm93Q3VzdG9tVmFsaWRpdHlcIiwgbU5ld0N1c3RvbVZhbGlkaXR5KTtcblx0XHRcdC8vIFJlbW92ZSBleGlzdGluZyBDdXN0b21WYWxpZGF0aW9uIG1lc3NhZ2Vcblx0XHRcdGNvbnN0IG9NZXNzYWdlTWFuYWdlciA9IHNhcC51aS5nZXRDb3JlKCkuZ2V0TWVzc2FnZU1hbmFnZXIoKTtcblx0XHRcdGNvbnN0IHNUYXJnZXQgPSBgJHtvU291cmNlRmllbGQuZ2V0QmluZGluZ0NvbnRleHQoKS5nZXRQYXRoKCl9LyR7b1NvdXJjZUZpZWxkLmdldEJpbmRpbmdQYXRoKFwidmFsdWVcIil9YDtcblx0XHRcdG9NZXNzYWdlTWFuYWdlclxuXHRcdFx0XHQuZ2V0TWVzc2FnZU1vZGVsKClcblx0XHRcdFx0LmdldERhdGEoKVxuXHRcdFx0XHQuZm9yRWFjaChmdW5jdGlvbiAob01lc3NhZ2U6IGFueSkge1xuXHRcdFx0XHRcdGlmIChvTWVzc2FnZS50YXJnZXQgPT09IHNUYXJnZXQpIHtcblx0XHRcdFx0XHRcdG9NZXNzYWdlTWFuYWdlci5yZW1vdmVNZXNzYWdlcyhvTWVzc2FnZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IFRhYmxlUnVudGltZTtcbiJdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUE7QUFBQTs7OztFQWFBLE1BQU1BLFlBQVksR0FBR0MsU0FBUyxDQUFDRCxZQUFZO0VBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNBLE1BQU1FLFlBQVksR0FBRztJQUNwQkMsb0JBQW9CLEVBQUUsVUFBVUMsTUFBVyxFQUFFO01BQzVDO0FBQ0Y7QUFDQTtBQUNBO01BQ0UsTUFBTUMsT0FBTyxHQUFHRCxNQUFNLENBQUNFLFNBQVMsRUFBRSxDQUFDQyxTQUFTLEVBQUU7UUFDN0NDLGVBQWUsR0FBR0MsR0FBRyxDQUFDQyxFQUFFLENBQUNDLE9BQU8sRUFBRSxDQUFDQyxJQUFJLENBQUUsR0FBRVAsT0FBTyxDQUFDUSxLQUFLLEVBQUcsV0FBVSxDQUFDO01BQ3ZFQyxXQUFXLENBQUNDLGVBQWUsQ0FBQ1AsZUFBZSxDQUFXO0lBQ3ZELENBQUM7SUFDRFEsZ0NBQWdDLEVBQUUsVUFBVUMsY0FBbUIsRUFBRUMsT0FBWSxFQUFFO01BQzlFO01BQ0EsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUNYLFNBQVMsRUFBRTtNQUNyQyxJQUFJVSxjQUFjLEtBQUtqQixZQUFZLENBQUNvQixXQUFXLEVBQUU7UUFDaEQsTUFBTUMsT0FBTyxHQUFHRixTQUFTLENBQ3ZCRyxVQUFVLEVBQUUsQ0FDWkMsTUFBTSxDQUFDLFVBQVVDLGNBQW1CLEVBQUVDLG9CQUF5QixFQUFFO1VBQ2pFLE9BQU9ELGNBQWMsQ0FBQ0UsTUFBTSxDQUFDRCxvQkFBb0IsQ0FBQ0UsU0FBUyxFQUFFLENBQUM7UUFDL0QsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUNMQyxJQUFJLENBQUMsVUFBVUMsYUFBa0IsRUFBRTtVQUNuQyxPQUFPQSxhQUFhLENBQUNoQixLQUFLLEVBQUUsQ0FBQ2lCLFFBQVEsQ0FBQ2IsY0FBYyxDQUFDO1FBQ3RELENBQUMsQ0FBQztRQUNISCxXQUFXLENBQUNDLGVBQWUsQ0FBQ00sT0FBTyxDQUFDO01BQ3JDLENBQUMsTUFBTTtRQUNOLE1BQU1VLFlBQVksR0FBR1osU0FBUyxDQUFDYSxjQUFjLENBQUMsYUFBYSxDQUFDO1FBQzVELElBQUlELFlBQVksSUFBSUEsWUFBWSxDQUFDRSxlQUFlLEVBQUUsSUFBSUYsWUFBWSxDQUFDRyxVQUFVLEVBQUUsRUFBRTtVQUNoRkgsWUFBWSxDQUFDSSxTQUFTLEVBQUU7UUFDekI7TUFDRDtJQUNELENBQUM7SUFFREMsV0FBVyxFQUFFLFVBQ1pDLE1BQWEsRUFDYkMsY0FBc0IsRUFDdEJDLEtBQWEsRUFDYkMsV0FBbUIsRUFDbkJDLHVCQUErQixFQUMvQkMsMkJBQW1DLEVBQ25DQyxjQUFzQixFQUNyQjtNQUNEQyxVQUFVLENBQUNDLElBQUksQ0FBQ1IsTUFBTSxDQUFDO01BQ3ZCLE9BQU9uQyxZQUFZLENBQUM0QyxnQkFBZ0IsQ0FDbkNULE1BQU0sRUFDTkMsY0FBYyxFQUNkQyxLQUFLLEVBQ0xDLFdBQVcsRUFDWEMsdUJBQXVCLEVBQ3ZCQywyQkFBMkIsRUFDM0JDLGNBQWMsQ0FDZCxDQUNDSSxJQUFJLENBQUMsTUFBTTtRQUNYQyxHQUFHLENBQUNDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQztNQUMvQixDQUFDLENBQUMsQ0FDREMsS0FBSyxDQUFFQyxLQUFLLElBQUs7UUFDakJILEdBQUcsQ0FBQ0csS0FBSyxDQUFDQSxLQUFLLENBQUM7TUFDakIsQ0FBQyxDQUFDLENBQ0RDLE9BQU8sQ0FBQyxNQUFNO1FBQ2RSLFVBQVUsQ0FBQ1MsTUFBTSxDQUFDaEIsTUFBTSxDQUFDO01BQzFCLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRFMsZ0JBQWdCLEVBQUUsZ0JBQ2pCVCxNQUFhLEVBQ2JDLGNBQXNCLEVBQ3RCQyxLQUFhLEVBQ2JDLFdBQW1CLEVBQ25CQyx1QkFBK0IsRUFDL0JDLDJCQUFtQyxFQUNuQ0MsY0FBc0IsRUFDUTtNQUM5QixNQUFNVywyQkFBMkIsR0FBR1osMkJBQTJCLEdBQUdBLDJCQUEyQixDQUFDYSxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtNQUM3RyxNQUFNQyw0QkFBNEIsR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUNsQixXQUFXLENBQUM7TUFDNUQsTUFBTW1CLHVCQUF1QixHQUM1QmxCLHVCQUF1QixJQUFJQSx1QkFBdUIsS0FBSyxXQUFXLElBQUlnQixJQUFJLENBQUNDLEtBQUssQ0FBQ2pCLHVCQUF1QixDQUFDO01BQzFHLElBQUltQixpQkFBaUIsR0FBR3ZCLE1BQU0sQ0FBQ3dCLG1CQUFtQixFQUFlO01BQ2pFLE1BQU1DLGtCQUE2QixHQUFHLEVBQUU7TUFDeEMsTUFBTUMscUJBQXFCLEdBQUcxQixNQUFNLENBQUMyQixJQUFJLENBQUMsNEJBQTRCLENBQUMsS0FBSyxNQUFNLElBQUl6QixLQUFLLEtBQUssV0FBVztNQUMzRyxNQUFNMEIsa0JBQTZCLEdBQUcsRUFBRTtNQUN4QztNQUNBO01BQ0EsTUFBTUMsZUFBb0QsR0FBRyxDQUFDLENBQUM7TUFDL0QsTUFBTUMsSUFBSSxHQUFHLENBQUMsQ0FBQztNQUNmLE1BQU1DLHFCQUFxQixHQUFHL0IsTUFBTSxDQUFDZ0MsaUJBQWlCLENBQUMsVUFBVSxDQUF5QjtNQUUxRixJQUFJLENBQUNELHFCQUFxQixFQUFFO1FBQzNCO01BQ0Q7TUFDQTtNQUNBUixpQkFBaUIsR0FBR0EsaUJBQWlCLENBQUNVLE1BQU0sQ0FBQyxVQUFVQyxRQUFpQixFQUFFO1FBQ3pFLE9BQU8sQ0FBQ0EsUUFBUSxDQUFDQyxVQUFVLEVBQUU7TUFDOUIsQ0FBQyxDQUFDO01BRUYsTUFBTUMsWUFBWSxHQUFHQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ1AscUJBQXFCLENBQUNRLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxFQUFFO1FBQzNFQyxnQkFBZ0IsRUFBRWpCLGlCQUFpQjtRQUNuQ2tCLHdCQUF3QixFQUFFbEIsaUJBQWlCLENBQUNtQixNQUFNO1FBQ2xEQyxjQUFjLEVBQUVkLGVBQWU7UUFDL0JlLEdBQUcsRUFBRWQsSUFBSTtRQUNUZSxhQUFhLEVBQUUsSUFBSTtRQUNuQkMsaUJBQWlCLEVBQUVyQixrQkFBa0I7UUFDckNzQixlQUFlLEVBQUUsRUFBRTtRQUNuQkMsY0FBYyxFQUFFLEVBQUU7UUFDbEJDLDRCQUE0QixFQUFFLEVBQUU7UUFDaENDLHlCQUF5QixFQUFFLEVBQUU7UUFDN0JDLGtCQUFrQixFQUFFLEVBQUU7UUFDdEJDLFNBQVMsRUFBRSxFQUFFO1FBQ2JDLGlCQUFpQixFQUFFekIsa0JBQWtCO1FBQ3JDMEIsNEJBQTRCLEVBQUV2QixxQkFBcUIsQ0FBQ3dCLFdBQVcsQ0FBQyw4QkFBOEIsQ0FBQyxHQUM1RnhCLHFCQUFxQixDQUFDd0IsV0FBVyxDQUFDLDhCQUE4QixDQUFDLEdBQ2pFQztNQUNKLENBQUMsQ0FBQztNQUVGLEtBQUssTUFBTUMsZ0JBQWdCLElBQUlsQyxpQkFBaUIsRUFBRTtRQUNqRCxNQUFNbUMsWUFBWSxHQUFHRCxnQkFBZ0IsQ0FBQ2xCLFNBQVMsRUFBRTtRQUNqRCxLQUFLLE1BQU1vQixHQUFHLElBQUlELFlBQVksRUFBRTtVQUMvQixJQUFJQyxHQUFHLENBQUNDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDM0IsSUFBSUMsV0FBbUIsR0FBR0YsR0FBRztZQUM3QkUsV0FBVyxHQUFHQSxXQUFXLENBQUNDLFNBQVMsQ0FBQyxDQUFDLEVBQUVELFdBQVcsQ0FBQ25CLE1BQU0sQ0FBQztZQUMxRE4sWUFBWSxDQUFDTyxjQUFjLENBQUNrQixXQUFXLENBQUMsR0FBRztjQUFFRSxPQUFPLEVBQUU7WUFBSyxDQUFDO1lBQzVEaEMscUJBQXFCLENBQUNpQyxXQUFXLENBQUMsRUFBRSxFQUFFNUIsWUFBWSxDQUFDO1VBQ3BEO1FBQ0Q7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLE1BQU02QixnQkFBZ0IsR0FBRzNELGNBQWMsQ0FBQ29DLE1BQU0sS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDZSxnQkFBZ0IsQ0FBQ0YsV0FBVyxDQUFDakQsY0FBYyxDQUFDO1FBQ3RHLE1BQU00RCx1QkFBdUIsR0FBRyxDQUFDeEMscUJBQXFCLElBQUlnQyxZQUFZLENBQUNTLGNBQWM7UUFDckYsSUFBSUYsZ0JBQWdCLElBQUlDLHVCQUF1QixFQUFFO1VBQ2hEdEMsa0JBQWtCLENBQUN3QyxJQUFJLENBQUNYLGdCQUFnQixDQUFDO1FBQzFDO01BQ0Q7TUFFQVksWUFBWSxDQUFDQyxtQ0FBbUMsQ0FBQ3ZDLHFCQUFxQixFQUFFUixpQkFBaUIsQ0FBQztNQUUxRixJQUFJLENBQUN2QixNQUFNLENBQUMyQixJQUFJLENBQUMsaUJBQWlCLENBQUMsRUFBRTtRQUNwQzRDLFdBQVcsQ0FBQ0MsZ0JBQWdCLENBQUN6QyxxQkFBcUIsRUFBRVQsdUJBQXVCLEVBQUVDLGlCQUFpQixDQUFDO01BQ2hHO01BRUEsSUFBSUEsaUJBQWlCLENBQUNtQixNQUFNLEdBQUcsQ0FBQyxFQUFFO1FBQ2pDLElBQUksQ0FBQytCLGFBQWEsQ0FBQ3hELDJCQUEyQixFQUFFWSxlQUFlLENBQUM7TUFDakU7TUFFQSxJQUFJTyxZQUFZLEVBQUU7UUFDakJBLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHUixrQkFBa0I7UUFDdERRLFlBQVksQ0FBQyxXQUFXLENBQUMsR0FBR3BDLE1BQU0sQ0FBQ3hCLEtBQUssRUFBRTtRQUMxQ3VELHFCQUFxQixDQUFDaUMsV0FBVyxDQUFDLEVBQUUsRUFBRTVCLFlBQVksQ0FBQztNQUNwRDtNQUVBLE9BQU9zQyxhQUFhLENBQUNDLG1CQUFtQixDQUFDNUMscUJBQXFCLEVBQUVaLDRCQUE0QixFQUFFSSxpQkFBaUIsRUFBRSxPQUFPLENBQUM7SUFDMUgsQ0FBQztJQUVEa0QsYUFBYSxFQUFFLFVBQVV4RCwyQkFBZ0MsRUFBRVksZUFBb0IsRUFBRTtNQUNoRlosMkJBQTJCLENBQUMyRCxPQUFPLENBQUMsVUFBVUMsT0FBWSxFQUFFO1FBQzNEaEQsZUFBZSxDQUFDZ0QsT0FBTyxDQUFDLEdBQUc7VUFBRUMsUUFBUSxFQUFFO1FBQU0sQ0FBQztNQUMvQyxDQUFDLENBQUM7SUFDSCxDQUFDO0lBQ0RDLDBCQUEwQixFQUFFLFVBQVVoSCxNQUFXLEVBQUVpSCx5QkFBOEIsRUFBRTtNQUNsRjtNQUNBLE1BQU1DLE1BQU0sR0FBR0MsWUFBWSxDQUFDQyxxQkFBcUIsQ0FBQ3BILE1BQU0sQ0FBQztRQUN4RHFILFlBQVksR0FBR0gsTUFBTSxDQUFDSSxLQUFLO1FBQzNCQyxRQUFRLEdBQUdGLFlBQVksQ0FBQzVHLEtBQUssRUFBRTtNQUVoQyxNQUFNdUQscUJBQXFCLEdBQUdxRCxZQUFZLENBQUNwRCxpQkFBaUIsQ0FBQyxVQUFVLENBQUM7UUFDdkV1RCxjQUFjLEdBQUd4RCxxQkFBcUIsQ0FBQ3dCLFdBQVcsQ0FBQywwQkFBMEIsQ0FBQztRQUM5RWlDLGlCQUFpQixHQUFHbkQsTUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUVpRCxjQUFjLENBQUM7TUFFdERDLGlCQUFpQixDQUFDRixRQUFRLENBQUMsR0FBR0wsTUFBTSxDQUFDUSxLQUFLO01BQzFDMUQscUJBQXFCLENBQUNpQyxXQUFXLENBQUMsMEJBQTBCLEVBQUV3QixpQkFBaUIsQ0FBQzs7TUFFaEY7TUFDQSxJQUFJUix5QkFBeUIsRUFBRTtRQUM5QixNQUFNVSxlQUFlLEdBQUczRCxxQkFBcUIsQ0FBQ3dCLFdBQVcsQ0FBQywyQkFBMkIsQ0FBQztVQUNyRm9DLGtCQUFrQixHQUFHdEQsTUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUVvRCxlQUFlLENBQUM7UUFDeERDLGtCQUFrQixDQUFDUCxZQUFZLENBQUNRLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFLENBQUMsR0FBRztVQUNoRUMsT0FBTyxFQUFFVixZQUFZLENBQUM1RyxLQUFLO1FBQzVCLENBQUM7UUFDRHVELHFCQUFxQixDQUFDaUMsV0FBVyxDQUFDLDJCQUEyQixFQUFFMkIsa0JBQWtCLENBQUM7UUFDbEY7UUFDQSxNQUFNSSxlQUFlLEdBQUczSCxHQUFHLENBQUNDLEVBQUUsQ0FBQ0MsT0FBTyxFQUFFLENBQUMwSCxpQkFBaUIsRUFBRTtRQUM1RCxNQUFNQyxPQUFPLEdBQUksR0FBRWIsWUFBWSxDQUFDcEQsaUJBQWlCLEVBQUUsQ0FBQzZELE9BQU8sRUFBRyxJQUFHVCxZQUFZLENBQUNjLGNBQWMsQ0FBQyxPQUFPLENBQUUsRUFBQztRQUN2R0gsZUFBZSxDQUNiSSxlQUFlLEVBQUUsQ0FDakJDLE9BQU8sRUFBRSxDQUNUeEIsT0FBTyxDQUFDLFVBQVV5QixRQUFhLEVBQUU7VUFDakMsSUFBSUEsUUFBUSxDQUFDQyxNQUFNLEtBQUtMLE9BQU8sRUFBRTtZQUNoQ0YsZUFBZSxDQUFDUSxjQUFjLENBQUNGLFFBQVEsQ0FBQztVQUN6QztRQUNELENBQUMsQ0FBQztNQUNKO0lBQ0Q7RUFDRCxDQUFDO0VBQUMsT0FFYXhJLFlBQVk7QUFBQSJ9