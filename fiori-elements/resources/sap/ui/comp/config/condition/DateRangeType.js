/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/DatePicker","sap/m/Text","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/comp/config/condition/NullableInteger","sap/ui/model/Sorter","sap/ui/model/Filter","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/CustomDynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/base/util/UriParameters","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos"],function(e,t,a,n,i,r,o,l,s,u,g,T,p,f,E,d,c,I,D,h,y,v,N,m,_,O,A,S,R,C){"use strict";var F=i.ValueState;var x=o.PlacementType;var M=Object.keys(o.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var P;var Y;var L;var b=a.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(e,t,n){a.apply(this,[e,t,n]);this.oDateFormat=t&&t._oDateFormatSettings?t._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var i=this.oFieldMetadata&&this.oFieldMetadata.name,o=t&&t._oAdditionalConfiguration&&t._oAdditionalConfiguration.getControlConfigurationByKey(e)||i&&t._oAdditionalConfiguration.getControlConfigurationByKey(i);this._bSingleFilterRestriction=n&&n.filterRestriction===r.smartfilterbar.FilterType.single&&(t._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=n&&n.filterRestriction===r.smartfilterbar.FilterType.interval&&n.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});b.prototype.applySettings=function(e){a.prototype.applySettings.apply(this,arguments);if(e&&e.ignoreTime){this._bIgnoreTime=e.ignoreTime}};b.setStartTime=function(e){e=b.toUniversalDate(e);return v.resetStartTime(e)};b.setEndTime=function(e,t){e=b.toUniversalDate(e);if(!t){return v.resetEndTime(e)}else{return v.resetStartTime(e)}};b.toUniversalDate=function(t){if(t instanceof Date){return f.getInstance(t)}if(!t){return f.getInstance()}if(!(t instanceof f)){return b.toUniversalDate(e.getInstance(t))}return t};b.getWeekStartDate=function(e){return v.getWeekStartDate(e)};b.getMonthStartDate=function(e){return v.getMonthStartDate(e)};b.getQuarterStartDate=function(e){return v.getQuarterStartDate(e)};b.getYearStartDate=function(e){return v.getYearStartDate(e)};b.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new f}else{a=new f(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=v.getWeekStartDate(a);break;case"MONTH":a=v.getMonthStartDate(a);break;case"QUARTER":a=v.getQuarterStartDate(a);break;case"YEAR":a=v.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return v.getRange(e,t,a,false)};b.getTextField=function(e,t){var n=a._createStableId(e,"text");if(e._oOperationSelect){var i=e._oOperationSelect.getAriaLabelledBy();var r=false;for(var o=0;o<i.length;o++){if(n===i[o]){r=true;break}}if(!r){e._oOperationSelect.addAriaLabelledBy(n)}}if(t){return new u(n,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"}"})}else{return new u(n,{text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:e.oDateFormat.style,pattern:e.oDateFormat.pattern}}})}};b.getIntField=function(e){return new l(a._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new I({},{minimum:0,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};b.getIntFromToField=function(e,t,n){var i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var r=e._createIntFromToControl(e,"fieldFrom","value1");i.setLabelFor(r);t.push(r);i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var o=e._createIntFromToControl(e,"fieldTo","value2");i.setLabelFor(o);t.push(o);e._setIntControlBinding(r,n,"value1");e._setIntControlBinding(o,n,"value2")};b.ControlFactory=function(e,t,n){if(n.type==="range"){var i=b.getTextField(e,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);return}if(n.type==="int"){var i=b.getIntField(e);t.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var e=n.descriptionTextKeys[0];var t=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(t||e)}}})}}if(n.type==="[int,int]"){b.getIntFromToField(e,t,n)}};b._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};b._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};b._IntFromToOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("-{0}")>=0&&this.basicLanguageText.indexOf("+{1}")>=0){var a=new RegExp(this.basicLanguageText.replace("/","\\/").replace("-{0}","(\\- (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)").replace("+{1}","(\\+ (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)")+"$","i");var n=e.match(a);if(n){var i=n[3];var r=n[9];if(i&&r){var o=parseInt(i);var l=parseInt(r);if(t._isValidFromToPeriod(o,l)){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",l);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};b._DateOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length);if(a.length>0&&a[0]===" "){a=a.trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=t._getDateFormatter(true);var i=n.parse(a);if(i){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",i);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}return false};b._DateWithDefaultsOnChangeHandler=function(e,t){var a,n,i,r,o,l=e.toLowerCase().indexOf(this.languageText.toLowerCase())===0;if(l){a=t._getDateFormatter(true);n=typeof this.defaultValues==="function"&&this.defaultValues();i=n[0]&&n[0].oDate;if(e.indexOf(this.languageText+" ")===0){r=e.slice(this.languageText.length+1);if(r[0]==="("&&r[r.length-1]===")"){r=r.slice(1,r.length-1)}}o=a.parse(r);if(o instanceof Date&&o.getTime()!==i.getTime()){return false}}return b._DateOnChangeHandler.apply(this,arguments)};b._DateRangeOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length).trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=a.split("-")[0];var i=a.split("-")[1];var r=t._getDateFormatter(true);var o=r.parse(n);var l=r.parse(i);if(o&&l){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",l);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};b._MonthOnChangeHandler=function(e,t){var a;var n=false;if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){a=e.slice(this.languageText.length).trim();if(a.indexOf("(")==0){a=a.slice(1);a=a.slice(0,a.length-1)}n=true}else{a=e}var i=this.getValueList();var r=-1;i.some(function(e,t){var n=e.text.toLowerCase()===a.toLowerCase();if(n){r=t}return n});if(r>-1){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",r);t.oModel.setProperty("inputstate","NONE",t.getContext());return true}else{if(n){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return n}};b._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};b._HideFilterSuggestItem=function(e,t,a){return false};b._IntFilterSuggestItem=function(e,t,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||a.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var l=e.split(" ");if(l.length<1||l.length>3){return false}var s=false;var u;var g=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(l[0].toLowerCase())){if(l[1]){if(g(l[1])){u=l[1];if(l[2]){if(o.toLowerCase().startsWith(l[2].toLowerCase())){s=true}}else{s=true}}}else{s=true}}else if(g(l[0])&&l.length<3){u=l[0];if(l[1]){if(o.toLowerCase().startsWith(l[1].toLowerCase())){s=true}}else{s=true}}else if(o.toLowerCase().startsWith(l[0].toLowerCase())&&l.length==1){s=true}if(s&&u){var T;switch(this.category){case"DYNAMIC.DATE.INT":T="DAY";break;case"DYNAMIC.WEEK.INT":T="WEEK";break;case"DYNAMIC.MONTH.INT":T="MONTH";break;case"DYNAMIC.QUARTER.INT":T="QUARTER";break;case"DYNAMIC.YEAR.INT":T="YEAR";break;default:T="DAY";break}var p=parseInt(u),f=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(p>n._maxIntValue){s=false}if(this.key.startsWith("LAST")){p=p*-1;f=false}var E;if(this.getDateRange){var d=this.getDateRange({operation:this.key,value1:p});E=[d.value1,d.value2]}else{E=b.getDateRange(p,T,true,f,f)}var c=n._getDateFormatter(true);if(Math.abs(p)===1&&this.singulareBasicLanguageText){t.setText(this.singulareBasicLanguageText);if(T!=="DAY"){t.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}else{t.setAdditionalText(c.format(E[0]))}}else{t.setText(n._fillNumberToText(this.basicLanguageText,u));t.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}t._value1=parseInt(u)}else{t.setAdditionalText(null);t.setText(this.languageText);t._value1=null}return s};b._IntFromToFilterSuggestItem=function(e,t,a){var n=new RegExp("(\\- ([0-9]+))","i"),i=new RegExp("(\\+ ([0-9]+))","i"),r=new RegExp("(\\- ((\\(-)?([0-9]+)(\\)))?)","i"),o=new RegExp("(\\+ ((\\(-)?([0-9]+)(\\)))?)","i"),l=e.match(n),s=e.match(i),u=e.match(r),g=e.match(o);if(!l&&!u||!s&&!g){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var T=function(e,t){if(e&&!isNaN(e[2])){return parseInt(e[2])}else if(t&&t[2]){var a=t[2].replace("(","").replace(")","");if(!isNaN(a)){return parseInt(a)}}return null},p,f;p=T(l,u);f=T(s,g);if(!a._isValidFromToPeriod(p,f)){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var E=a._getDateFormatter(true),d,c;d=a._getTodayFromToValueFrom(p);c=a._getTodayFromToValueTo(f);t.setText(a._fillNumberToText(this.basicLanguageText,p,f));t.setAdditionalText(E.format(d)+" - "+E.format(c));t._value1=p;t._value2=f;return true};b._DateFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i=n.parse(e);if(i){t.setText(this.languageText+" ("+n.format(i)+")");t._value1=i;return true}else{t.setText(this.languageText);t._value1=null;return false}};b._DateRangeFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i,r;var o="-";var l=false;var s=e.split(o);if(s.length===2){if(s[0].slice(s[0].length-1,s[0].length)==" "){s[0]=s[0].slice(0,s[0].length-1)}if(s[1].slice(0,1)==" "){s[1]=s[1].slice(1)}}else{s=e.split(" "+o+" ")}if(s.length<2){var u=e.split(" ");if(u.length===2){s=u}}if(s.length>=1&&s.length<=2){i=n.parse(s[0]);if(i){t._value1=i;if(s.length==2&&s[1]===""){s.splice(1,1)}if(s.length==2){r=n.parse(s[1]);if(r){t._value2=r;l=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+" "+n.format(r)+")")}}else{l=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+")")}}}if(!l){t.setText(this.languageText);t._value1=null;t._value2=null}return l};b._MonthFilterSuggestItem=function(e,t,a){var n=false;t._value1=null;var i=this.getValueList();for(var r=0;r<i.length;r++){var o=i[r];n=o.text.toLowerCase().startsWith(e.toLowerCase());if(n){t.setText(this.languageText+" ("+o.text+")");t._value1=r;break}}return n};b._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};b._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};b._IntOnItemsSelected=function(e,t,a){var n=t._value1;var i=t._value2;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("/condition/value2",i);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};b.getFixedRangeOperation=function(e,t,a,n,i,r){return{key:e,textKey:t,category:a,order:r||100,defaultValues:n||null,type:"range",display:"range",filterSuggestItem:i||b._DefaultFilterSuggestItem,onItemSelected:b._DefaultOnItemSelected,getControls:b.ControlFactory}};b.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,l){return{key:e,textKey:t,singularTextKey:a,zeroNumberTextKey:l,category:n,order:o,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:r,onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory,_getInitialValues:function(e){return[e.value1,e.value2]}}};b.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:b._DateRangeOnChangeHandler,filterSuggestItem:b._DateRangeFilterSuggestItem,onItemSelected:b._DefaultOnItemSelected,getControls:function(e,t){var n=false,i=false,r=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(r);var o=new s(a._createStableId(e,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(t){var a=t.getSource(),i=t.getParameter("valid");a.setValueState(i?F.None:F.Error);if(!n){n=true;a.getBinding("maxDate").attachChange(function(t){e.datePickerValidateLastValue(a)})}}});r.setLabelFor(o);t.push(o);r=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(r);var l=new s(a._createStableId(e,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(t){var a=t.getSource(),n=t.getParameter("valid");a.setValueState(n?F.None:F.Error);if(!i){i=true;a.getBinding("minDate").attachChange(function(t){e.datePickerValidateLastValue(a)})}}});r.setLabelFor(l);t.push(l)}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:b._DateOnChangeHandler,filterSuggestItem:b._DateFilterSuggestItem,onItemSelected:b._DefaultOnItemSelected,getControls:function(e,t){var n=new s(a._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});t.push(n)}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:b._DateOnChangeHandler,filterSuggestItem:b._DateFilterSuggestItem,onItemSelected:b._DefaultOnItemSelected,getControls:function(e,t){var n=new s(a._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});t.push(n)}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:b._DateOnChangeHandler,filterSuggestItem:b._DateFilterSuggestItem,onItemSelected:b._DefaultOnItemSelected,getControls:function(e,t,n){var i=new s(a._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});t.push(i)}},LASTDAYS:b.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4,"CONDITION_DATERANGETYPE_TODAY"),LASTWEEKS:b.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8,"CONDITION_DATERANGETYPE_THISWEEK"),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",zeroNumberTextKey:"CONDITION_DATERANGETYPE_TODAY",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:b._IntOnChangeHandler,filterSuggestItem:b._IntFilterSuggestItem,onItemSelected:b._IntOnItemSelected,getControls:b.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new f;return[e.getMonth()]},value1:null,onChange:b._MonthOnChangeHandler,onItemSelected:b._DefaultOnItemSelected,filterSuggestItem:b._MonthFilterSuggestItem,getControls:function(e,t,n){var i=new g(a._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});i.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new T({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});t.push(i)},getValueList:function(){var e=new f,t=[],a=E.getDateInstance({pattern:"LLLL"});e.setDate(15);e.setMonth(0);for(var n=0;n<12;n++){t.push({text:a.format(e),key:n});e.setMonth(e.getMonth()+1)}return t}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return v.ranges.yesterday()},type:"range",display:"start",onChange:b._DateWithDefaultsOnChangeHandler,onItemSelected:b._DefaultOnItemSelected,getControls:b.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return v.ranges.today()},type:"range",display:"start",onChange:b._DateWithDefaultsOnChangeHandler,onItemSelected:b._DefaultOnItemSelected,getControls:b.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=v.ranges.tomorrow();return e},type:"range",display:"start",onChange:b._DateWithDefaultsOnChangeHandler,onItemSelected:b._DefaultOnItemSelected,getControls:b.ControlFactory},THISWEEK:b.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return v.ranges.currentWeek()},b._DefaultFilterSuggestItem,6),LASTWEEK:b.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return v.ranges.lastWeek()},b._DefaultFilterSuggestItem,7),LAST2WEEKS:b.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-2)},b._HideFilterSuggestItem,-1),LAST3WEEKS:b.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-3)},b._HideFilterSuggestItem,-1),LAST4WEEKS:b.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-4)},b._HideFilterSuggestItem,-1),LAST5WEEKS:b.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-5)},b._HideFilterSuggestItem,-1),NEXTWEEK:b.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return v.ranges.nextWeek()},b._DefaultFilterSuggestItem,9),NEXT2WEEKS:b.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(2)},b._HideFilterSuggestItem,-1),NEXT3WEEKS:b.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(3)},b._HideFilterSuggestItem,-1),NEXT4WEEKS:b.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(4)},b._HideFilterSuggestItem,-1),NEXT5WEEKS:b.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(5)},b._HideFilterSuggestItem,-1),THISMONTH:b.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return v.ranges.currentMonth()},b._DefaultFilterSuggestItem,12),LASTMONTH:b.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return v.ranges.lastMonth()},b._DefaultFilterSuggestItem,13),NEXTMONTH:b.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return v.ranges.nextMonth()},b._DefaultFilterSuggestItem,15),THISQUARTER:b.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return v.ranges.currentQuarter()},b._DefaultFilterSuggestItem,17),LASTQUARTER:b.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return v.ranges.lastQuarter()},b._DefaultFilterSuggestItem,18),NEXTQUARTER:b.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return v.ranges.nextQuarter()},b._DefaultFilterSuggestItem,20),YEARTODATE:b.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return v.ranges.yearToDate()},b._DefaultFilterSuggestItem,31),THISYEAR:b.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return v.ranges.currentYear()},b._DefaultFilterSuggestItem,26),LASTYEAR:b.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return v.ranges.lastYear()},b._DefaultFilterSuggestItem,27),NEXTYEAR:b.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return v.ranges.nextYear()},b._DefaultFilterSuggestItem,29),QUARTER1:b.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){return v.ranges.quarter(1)},b._DefaultFilterSuggestItem,22),QUARTER2:b.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){return v.ranges.quarter(2)},b._DefaultFilterSuggestItem,23),QUARTER3:b.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){return v.ranges.quarter(3)},b._DefaultFilterSuggestItem,24),QUARTER4:b.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){return v.ranges.quarter(4)},b._DefaultFilterSuggestItem,25),TODAYFROMTO:{key:"TODAYFROMTO",textKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",singularTextKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null,descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:b._IntFromToOnChangeHandler,filterSuggestItem:b._IntFromToFilterSuggestItem,onItemSelected:b._IntOnItemsSelected,getControls:b.ControlFactory}};b.SingleOperations={DATE:Object.assign({},b.Operations.DATE,{defaultOperation:true}),YESTERDAY:b.Operations.YESTERDAY,TODAY:b.Operations.TODAY,TOMORROW:b.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"FIRSTDAYWEEK",values:[]})}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"LASTDAYWEEK",values:[]})}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new S).toDates({operator:"LASTDAYYEAR",values:[]})}}};b.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new S).toDates({operator:"DATETOYEAR",values:[]})}}};b.DTOffsetOperations=Object.assign({NEXTMINUTES:{key:"NEXTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURS:{key:"NEXTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTES:{key:"LASTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURS:{key:"LASTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]}},b.Operations,b.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},b.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});b.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=b.ControlFactory}e.getControls(this,t,e);return t};b.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};a.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};b.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new f(n)}if(i instanceof Date){i=new f(i)}}return[n,i]};b.prototype.getOperations=function(){if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=b.Operations;if(this._isNewDynamicDateRangeEnabled()){t=Object.assign({},t,b.NewDynamicDateRangeOperations)}for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};b.prototype.getSingleOperations=function(){var e=[];for(var t in b.SingleOperations){var a=b.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};b.prototype.getDTOffsetOperations=function(){var e=[];for(var t in b.DTOffsetOperations){var a=b.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};b.prototype._updateOperation=function(e){a.prototype._updateOperation.apply(this,[e]);if(e.languageText&&!e.basicLanguageText){e.basicLanguageText=e.languageText;if(!e.singulareBasicLanguageText&&e.singularTextKey){e.singulareBasicLanguageText=this.getTranslatedText(e.singularTextKey)}if(!e.zeroNumberLanguageText&&e.zeroNumberTextKey){e.zeroNumberLanguageText=this.getTranslatedText(e.zeroNumberTextKey)}e.languageText=this._fillNumberToText(e.languageText)}if(e.display){var t=this.getDefaultValues(e);var n=this._getDateFormatter(false);if(e.display==="start"&&t[0]!==null){e.textValue=n.format(t[0].oDate)}else if(e.display==="range"&&t&&t[0]&&t[1]){e.textValue=n.format(t[0].oDate)+" - "+n.format(t[1].oDate)}}e.suggestText=e.languageText};b.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};b.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};b.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};b.prototype.providerDataUpdated=function(e,t){};b.prototype.initialize=function(t){a.prototype.initialize.apply(this,[t]);this.oModel.suspend();var n=Object.assign({},t,true),i,r;var o=(new f).getCalendarType();if(!t.conditionTypeInfo){if(t.ranges&&t.ranges.length==1){var l;if(this.hasSemanticDate(t)&&!this._bSingleFilterRestriction){l=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){i=t.ranges[0].semantic.value1}if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){r=t.ranges[0].semantic.value2}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(t):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==t.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==t.ranges[0].value2){l="DATERANGE"}}}else if(this.hasSemanticDate(t)&&this._bSingleFilterRestriction){l=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){i=t.ranges[0].semantic.value1}t.ranges[0].value2=null;if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){r=null}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(t):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==t.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==t.ranges[0].value2){l="DATE"}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()===i){i=t.ranges[0].value1?t.ranges[0].value1:t.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(t)){this._customSemanticOperation=t.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}}else if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}if(t.ranges[0].operation==="GE"){l="FROM"}if(t.ranges[0].operation==="LE"){l="TO"}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:l,value1:i||i==0?i:t.ranges[0].value1,value2:r||r==0?r:t.ranges[0].value2,calendarType:o}}}else{var s=this.getDefaultOperation(),g=s?s.key:"";if(t.value1){var T=t.value1}if(t.value2){var p=t.value2}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:g,calendarType:o}};if(T){t.conditionTypeInfo.data.value1=T}if(p){t.conditionTypeInfo.data.value2=p}}}if(t.conditionTypeInfo){t=t.conditionTypeInfo}if(t.name&&t.data){if(t.name!==this.getName()){y.debug("ConditionType "+this.getName()+" tries to deserialize data from "+t.name)}t=t.data}if(!t.operation){return}if(this.getOperation(t.operation)&&this.getOperation(t.operation).order<0){var E=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(t.operation);if(E>=0){t.operation="LASTWEEKS";t.value1=E+2}E=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(t.operation);if(E>=0){t.operation="NEXTWEEKS";t.value1=E+2}}var d=this.getOperation(t.operation);if(!d){if(this.getAsync()){this.setPending(true);var c=this,I=function(e){if(e.getParameter("pending")===false){c.oFilterProvider.detachPendingChange(I);c.initialize(n)}};this.oFilterProvider.attachPendingChange(I);this.oModel.resume();return}}var D;if(o!==t.calendarType&&(t.calendarType==="Islamic"||o==="Islamic")&&t.operation==="SPECIFICMONTH"){t.operation="DATERANGE";var h=parseInt(t.value1),N=f.getInstance(e.getInstance(),t.calendarType);N.setMonth(h);N=v.getMonthStartDate(N);D=v.getRange(0,"MONTH",N);t.value1=D[0].oDate.toISOString();t.value2=D[1].oDate.toISOString()}var m=this.getConditionContext().getObject();m.operation=t.operation;m.key=t.key;m.value1=null;m.value2=null;var _,O=this.oFieldMetadata&&this.oFieldMetadata.ui5Type;if(O&&O.isA("sap.ui.model.odata.type.String")){_=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));O=_}if(t.operation==="DATERANGE"){if(typeof t.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){t.value1=O.formatValue(t.value1)}else{t.value1=t.value1===""?null:new f(t.value1).oDate}}if(typeof t.value2==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){t.value2=O.formatValue(t.value2)}else{t.value2=t.value2===""?null:new f(t.value2).oDate}}m.value1=t.value1;m.value2=t.value2}else if(["DATE","FROM","TO"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){t.value1=O.formatValue(t.value1)}else{t.value1=t.value1===""?null:new f(t.value1).oDate}}m.value1=t.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new f(t.value1).oDate}m.value1=t.value1;if(typeof t.value2==="string"){t.value2=t.value2===""?null:new f(t.value2).oDate}m.value2=t.value2}else if(["LASTMINUTES","LASTHOURS","LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTMINUTES","NEXTHOURS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(t.operation)>-1){m.value1=t.value1}else if(t.operation==="SPECIFICMONTH"){m.value1=t.value1+""}else if(t.operation==="TODAYFROMTO"){m.value1=t.value1;m.value2=t.value2}else{d=this.getOperation(t.operation);D=d&&d._getInitialValues?d._getInitialValues(t):null;if(!D){D=this._getValuesFromCurrentOperation(t)}if(!D){D=this.getDefaultValues(d)}m.value1=D[0];m.value2=D[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,t);if(_){_.destroy()}};b.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};b.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new f).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};b.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n;var i=false;var r=0;var o=0;var l=0;var s=this.oModel.getData(),u=s.currentoperation;if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"&&e.ranges[0]){var g,T=this.oFieldMetadata.ui5Type;if(T.isA("sap.ui.model.odata.type.String")){g=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));T=g}e.conditionTypeInfo.data.value1=T.parseValue(e.conditionTypeInfo.data.value1);e.conditionTypeInfo.data.value2=T.parseValue(e.conditionTypeInfo.data.value2);e.ranges[0].value1=T.parseValue(e.ranges[0].value1);if(e.ranges[0].value2){e.ranges[0].value2=T.parseValue(e.ranges[0].value2)}if(g){g.destroy()}}if(u&&u.languageText){var p=u.languageText;if(this._isIntIntInterval(u)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){p=this._formatIntIntInterval(u,e)}n="NONE";if(!this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){n="ERROR"}}else if(this._isIntInterval(u)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){p=this._formatIntInterval(u,e);n="NONE"}else if(this._bSuggestItemSelected){p=this._fillNumberToText(u.basicLanguageText);var f=u.basicLanguageText.indexOf("{0}");r=f+1;o=f;l=f+1;i=true}else{p="";n="NONE"}}else if(this._isFixedRange(u)){p=this._formatFixedRange(u,u.textValue);n="NONE"}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var E=this._calculateDateRangeValueText(u,e);var d=E.value;i=E.bSetCursor;if(d){p=this._formatFixedRange(u,d);r=p.length-1;n="NONE"}else{p=""}}else{p=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",p);if(n&&!this._isNewDynamicDateRangeEnabled()){this.oModel.setProperty("inputstate",n,this.getContext())}if(i&&!(this._oPopup&&this._oPopup.isOpen())&&this._oInput){this._oInput.$("inner").cursorPos(r);if(o<l){this._oInput.selectText(o,l)}this._oInput._lastValue=""}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};b.prototype.getFilterRanges=function(){var e,t=this.getCondition(),a=[],n;if(this._bSingleFilterRestriction){t.operation="EQ";delete t.value2}else if(t.operation==="LASTMINUTES"){if(!isNaN(t.value1)){a=v.ranges.lastMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTHOURS"){if(!isNaN(t.value1)){a=v.ranges.lastHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTDAYS"){if(!isNaN(t.value1)){a=v.ranges.lastDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTWEEKS"){if(!isNaN(t.value1)){a=v.ranges.lastWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTMONTHS"){if(!isNaN(t.value1)){a=v.ranges.lastMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTQUARTERS"){if(!isNaN(t.value1)){a=v.ranges.lastQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTYEARS"){if(!isNaN(t.value1)){a=v.ranges.lastYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMINUTES"){if(!isNaN(t.value1)){a=v.ranges.nextMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTHOURS"){if(!isNaN(t.value1)){a=v.ranges.nextHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTDAYS"){if(!isNaN(t.value1)){a=v.ranges.nextDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTWEEKS"){if(!isNaN(t.value1)){a=v.ranges.nextWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMONTHS"){if(!isNaN(t.value1)){a=v.ranges.nextMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTQUARTERS"){if(!isNaN(t.value1)){a=v.ranges.nextQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTYEARS"){if(!isNaN(t.value1)){a=v.ranges.nextYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="SPECIFICMONTH"){var i=parseInt(t.value1),r=new f;if(Number.isFinite(i)){r.setDate(1);r.setMonth(i);r=v.getMonthStartDate(r);a=v.getRange(0,"MONTH",r);t.value1=a[0];t.value2=a[1]}}else if(t.operation==="TODAYFROMTO"){if(!isNaN(parseInt(t.value1))){t.value1=this._getTodayFromToValueFrom(t.value1)}if(!isNaN(parseInt(t.value2))){t.value2=this._getTodayFromToValueTo(t.value2)}}else{var o=this.getOperation(t.operation);if(o&&o.getDateRange){n=o.getDateRange(t);if(!n){return[]}t.value1=n&&n.value1?n.value1:null;t.value2=n&&n.value2?n.value2:null}}if(t.value1 instanceof f){t.value1=t.value1.oDate}if(t.value2 instanceof f){t.value2=t.value2.oDate}if(t.operation==="DATE"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="BT";t.value2=t.value1;t.value1=b.setStartTime(t.value1).oDate;t.value2=b.setEndTime(t.value2,this._bIgnoreTime,this._Precision).oDate}else if(t.operation==="FROM"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="GE";delete t.value2;t.value1=b.setStartTime(t.value1,this._bIgnoreTime).oDate}else if(t.operation==="TO"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="LE";delete t.value2;t.value1=b.setEndTime(t.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(!(this.isValidCondition()&&t.value1)){return[]}}else if(t.operation==="DATETIME"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="EQ";delete t.value2}else if(t.operation==="DATETIMERANGE"||t.operation==="LASTMINUTES"||t.operation==="LASTHOURS"||t.operation==="NEXTHOURS"||t.operation==="NEXTMINUTES"){if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT"}else{if(n){t.operation=n.operation;t.value1=t.value1?b.setStartTime(t.value1).oDate:null;t.value2=t.value2?b.setEndTime(t.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT";t.value1=b.setStartTime(t.value1).oDate;t.value2=b.setEndTime(t.value2,this._bIgnoreTime).oDate}}t.exclude=false;t.keyField=t.key;delete t.key;if(this._isNewDynamicDateRangeEnabled()&&t.value2){if(typeof t.value1.getTime==="function"&&typeof t.value2.getTime==="function"&&t.value1.getTime()>t.value2.getTime()){e=t.value2;t.value2=t.value1;t.value1=e}}return[t]};b.prototype.getTokenText=function(){return""};b.prototype.getName=function(){return this.getMetadata().getName()};b.prototype.getType=function(){return"Edm.Date"};b.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return F.Error}else{return F.None}}})};b.prototype.initializeFilterItem=function(){if(this._isNewDynamicDateRangeEnabled()){return this._initializeFilterItemNew.apply(this,arguments)}return this._initializeFilterItemOld.apply(this,arguments)};b.prototype._initializeFilterItemOld=function(){this._oInput=new l(a._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var e,t,a=this._oList.$().find(".sapMDLILabel, .sapMSLITitleOnly");for(e=0;e<a.length;e++){t=a[e];t.innerHTML=this._createHighlightedText(t)}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new D("order",false,false),filters:new h("order",function(e){return e!==undefined&&e>-1}),template:new T({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(e,t){if(this._oPopup&&this._oPopup.isOpen()){return false}var a=this.getOperation(t.getKey());e=e.trim();if(e==="?"){b._DefaultFilterSuggestItem.call(a,e,t,this);return a.category!=="DYNAMIC.DATERANGE"&&a.category!=="DYNAMIC.DATE"}if(a.filterSuggestItem){return a.filterSuggestItem(e,t,this)}else{return b._DefaultFilterSuggestItem.call(a,e,t,this)}}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){var t=e.getParameter("selectedItem");if(!t){return}var a=t.getKey();var n=this.getOperation(a);var i=e.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(i,t,this);return}else{b._DefaultOnItemSelected.call(n,i,t,this)}}.bind(this));this._oInput.attachChange(function(e){var t=e.getParameter("value");if(t){var a=this.getOperations();var n=a.some(function(e){if(e.onChange){return e.onChange(t,this)}else{return b._defaultOnChangeHandler.call(e,t,this)}},this);if(!n){this.oModel.setProperty("inputstate","ERROR",this.getContext())}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext())}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(e){if(t(e.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close()}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};b.prototype._toggleOpen=function(e){if(!this._oPopup){if((!P||!Y||n.system.phone&&!L)&&!this._bPopoverRequested){P=sap.ui.require("sap/m/ResponsivePopover");Y=sap.ui.require("sap/m/VBox");if(n.system.phone){L=sap.ui.require("sap/m/Button");if(!P||!Y||!L){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],V.bind(this));this._bPopoverRequested=true}}else if(!P||!Y){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],V.bind(this));this._bPopoverRequested=true}}if(!P||!Y||n.system.phone&&!L){return}this._oPopupLayout=new Y;this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new P({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:x.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem",afterClose:function(){if(K(this._oPopup)){this._oPopup.getModel("$smartEntityFilter").refresh(true)}if(this.oFilterProvider._oSmartFilter.getLiveMode()){var e=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(e.LIVE_MODE_INTERVAL)}}.bind(this)});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(n.system.phone){this._oPopup.setBeginButton(new L({text:a.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(e){this._oPopup.close()}.bind(this)}))}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setExtraContent([this._oInput.getDomRef()])}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon())}else{this._oPopup.close()}};function V(e,t,a){P=e;Y=t;L=a;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen()}}function K(e){var t,a,n=false,i=e.getContent()[0].getItems();for(t=0;t<i.length;t++){a=i[t];if(a.getMetadata().getName()==="sap.m.DatePicker"&&a.getValueState()!==F.None){n=true;break}}return n}b.prototype.datePickerValidateLastValue=function(e){var t;if(!e.isValidValue()){t=e.getValue();e.resetProperty("value");e.setValue(t);if(e.isValidValue()){e.setValueState(e.isValidValue()?F.None:F.Error)}}};b.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=E.getInstance(t)}return this._oDateFormatter};b.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};b.prototype._setIntControlBinding=function(e,t,n){e.setFieldWidth("auto");e.bindProperty("description",{path:"$smartEntityFilter>"+n,type:"sap.ui.model.type.Integer",formatter:function(){var e=t.descriptionTextKeys[0];var n=t.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(n||e)}}})};b.prototype._createIntFromToControl=function(e,t,n){return new l(a._createStableId(e,t),{value:{path:"$smartEntityFilter>"+n,type:new I({},{minimum:-e._maxIntValue,maximum:e._maxIntValue})},ariaLabelledBy:e._oOperationSelect||null,textAlign:"End",width:"100%"})};b.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};b.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=v.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return v.getRange(-e,"DAY")[0]};b.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=v.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return v.getRange(e,"DAY")[1]};b.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};b.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy()}a.prototype.destroy.apply(this,arguments)};b.prototype._initializeFilterItemNew=function(){this._createCustomDDOptions(this.getOperations());var e={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this._oInput=new N(a._createStableId(this),{name:this.sFieldName,formatter:_.getInstance({date:e}),enableGroupHeaders:!this._bSingleFilterRestriction,options:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.map(function(e){if(M.includes(e.key)){return e.key}return this._getCustomDDOptionName(e.key)}.bind(this))}.bind(this)},value:this._getDefaultValueDDR(),change:this._onDDRChange.bind(this)});this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};b.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}if(this._isNewDynamicDateRangeEnabled()){this._createCustomDDOptions(e)}this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};b.prototype.setCondition=function(e){a.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,e);return this};b.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};b.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!M.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};b.prototype._getDDROption=function(e){if(M.includes(e)){return m.getOption(e)}return m.getOption(this._getCustomDDOptionName(e))};b.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};b.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};b.prototype._createCustomDDOptions=function(e){e.forEach(this._createCustomDDOption,this)};b.prototype._createCustomDDOption=function(e){if(M.includes(e.key)){return}var t;var a=typeof e.category==="object"?e.category.key:e.category;if(a.toLowerCase().startsWith("fixed")||e.type==="range"){t=this._createCustomFixedDDOption(e)}else{t=this._createCustomDynamicDDOption(e)}t.getGroupHeader=function(){if(typeof e.category==="object"){var t=e.category.bundle;var a=e.category.key;if(sap.ui.getCore().getLibraryResourceBundle(t).hasText(a)){return sap.ui.getCore().getLibraryResourceBundle(t).getText(a)}}if(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText(e.category)}if(sap.ui.getCore().getLibraryResourceBundle("sap.m").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText(e.category)}return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_0")};t.getGroup=function(){return e.order};m.addOption(t)};b.prototype._createCustomFixedDDOption=function(e){var t=this;var n=new O({key:this._getCustomDDOptionName(e.key),getText:function(){return e.languageText||a.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!t.getOperation(t._getOptionName(e.key))){return false}var a=typeof e.category==="object"?e.category.key:e.category;if(a.toUpperCase().startsWith("FIXED.")&&e.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(a){var n=e.defaultValues;if(typeof n==="function"){n=n()}if(a&&n.length>0&&!(n[0]instanceof Date)){var i=t.oModel.getProperty("",t.oConditionContext),r=i.operation,o=n[0],l=n[1];i.operation=t._getOptionName(a.operator);i.value1=!isNaN(n[0])?parseInt(n[0]):n[0];i.value2=!isNaN(n[1])?parseInt(n[1]):n[1];var s=t.getFilterRanges();i.operation=r;i.value1=o;i.value2=l;if(s.length===0){return[]}return[s[0].value1]}return n},parse:function(t){var n=e.basicLanguageText||e.languageText||a.getTranslatedText(e.textKey);if(t&&n&&n.toLowerCase().startsWith(t.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return n};b.prototype._createCustomDynamicDDOption=function(e){var t=this;var n=new O({key:this._getCustomDDOptionName(e.key),getText:function(){var n=e.languageText||a.getTranslatedText(e.textKey);if(n.indexOf("{0}")>=0){return t._fillNumberToText(n)}return n},getValueHelpUITypes:function(){if(e.type==="int"){return[new A({type:"int"})]}else if(e.type==="[int,int]"){return[new A({type:"int"}),new A({type:"int"})]}},createValueHelpUI:function(a,n){a.aControlsByParameters={};a.aControlsByParameters[this.getKey()]=[];t.setControls([]);var i=t.getControls(e),r=e.defaultValues.length,o=e.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(e){if(!e.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}e.setValue(o[0]);o.shift();t.oModel.setProperty("/condition/value"+(r-o.length),e.getValue())}if(typeof n==="function"){e.attachChange(function(){n(this)},this)}a.aControlsByParameters[this.getKey()].push(e)},this);t.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var a=t.oModel.getProperty("",t.oConditionContext),n=a.operation,i=a.value1,r=a.value2;a.operation=t._getOptionName(e.operator);a.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];a.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=t.getFilterRanges();a.operation=n;a.value1=i;a.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(a){var n=new T({key:e.key}),i=e.filterSuggestItem.call(e,a,n,t);if(i){return{operator:this.getKey(),values:[n._value1,n._value2||null]}}return null},validateValueHelpUI:function(e){var a=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var n=this.getValueHelpUITypes();for(var i=0;i<n.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(n[i].getType()){case"int":return a.call(t,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return n};b.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var l=o.value;if(l){r=this._formatFixedRange(a,l)}else{r=""}}else{r=""}}}return r};b.prototype._isNewDynamicDateRangeEnabled=function(){if(!this.oFieldMetadata||this._bSingleFilterRestriction){return true}return!this.oFieldMetadata.disableNewDateRangeControl};b.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};b.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};b.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};b.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};b.prototype._isFixedRange=function(e){return e.textValue};b.prototype._formatFixedRange=function(e,t){if(this._isNewDynamicDateRangeEnabled()){return e.languageText}return e.languageText+" ("+t+")"};b.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n&&!(this._oPopup&&this._oPopup.isOpen())){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};b.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};b.prototype._prepareDDRValues=function(e,t,a){var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._getDDROption(a).toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=C.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=C.localToUiTimezone(i[1].oDate)}}return this._convertUniversalDateToDate(i)};b.prototype._setDDROperation=function(e){if(this._isNewDynamicDateRangeEnabled()&&this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=C.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=C.uiTimezoneToLocal(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return b});