/*!
 * Copyright (c) 2009-2023 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/core/Control","sap/ui/core/Core","sap/ui/Device","sap/ui/thirdparty/jquery","sap/ui/util/Storage","sap/ushell/Config","sap/ui/core/Configuration","sap/ushell/ui/shell/ShellLayoutRenderer","sap/ushell/library","sap/ushell/ui/shell/ToolArea"],function(e,t,a,i,o,l,n,r,s){"use strict";var p=t.extend("sap.ushell.ui.shell.ShellLayout",{metadata:{library:"sap.ushell",properties:{headerHiding:{type:"boolean",group:"Appearance",defaultValue:false,deprecated:true},headerVisible:{type:"boolean",group:"Appearance",defaultValue:true},toolAreaVisible:{type:"boolean",group:"Appearance",defaultValue:false},floatingContainerVisible:{type:"boolean",group:"Appearance",defaultValue:false},backgroundColorForce:{type:"boolean",group:"Appearance",defaultValue:true,deprecated:true},showBrandLine:{type:"boolean",group:"Appearance",defaultValue:true,deprecated:true},showAnimation:{type:"boolean",group:"Appearance",defaultValue:true,deprecated:true},enableCanvasShapes:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{toolArea:{type:"sap.ushell.ui.shell.ToolArea",multiple:false},rightFloatingContainer:{type:"sap.ushell.ui.shell.RightFloatingContainer",multiple:false},canvasSplitContainer:{type:"sap.ushell.ui.shell.SplitContainer",multiple:false},floatingActionsContainer:{type:"sap.ushell.ui.shell.ShellFloatingActions",multiple:false},footer:{type:"sap.ui.core.Control",multiple:false}},associations:{header:{type:"sap.ushell.ui.shell.ShellHeader",multiple:false},floatingContainer:{type:"sap.ushell.ui.shell.FloatingContainer",multiple:false}}},renderer:s});p._SIDEPANE_WIDTH_PHONE=13;p._SIDEPANE_WIDTH_TABLET=13;p._SIDEPANE_WIDTH_DESKTOP=15;p.prototype.getHeader=function(){return a.byId(this.getAssociation("header"))};p.prototype.init=function(){this._rtl=r.getRTL();this._showHeader=true;this._useStrongBG=false;i.media.attachHandler(this._handleMediaChange,this,i.media.RANGESETS.SAP_STANDARD);this._oDoable=n.on("/core/shellHeader/headerVisible").do(this.setHeaderVisible.bind(this));this._oStorage=new l(l.Type.local,"com.sap.ushell.adapters.local.FloatingContainer")};p.prototype.destroy=function(){i.media.detachHandler(this._handleMediaChange,this,i.media.RANGESETS.SAP_STANDARD);if(this._oDoable){this._oDoable.off();this._oDoable=null}if(this._oRm){this._oRm.destroy();this._oRm=null}t.prototype.destroy.apply(this,arguments)};p.prototype.onAfterRendering=function(){this._setSidePaneWidth();if(this.getEnableCanvasShapes()){sap.ui.require(["sap/ushell/CanvasShapesManager"],function(e){if(a.isThemeApplied()){e.drawShapes()}})}};p.prototype.renderFloatingContainerWrapper=function(){this._oFloatingContainerWrapper=document.getElementById("sapUshellFloatingContainerWrapper");if(!this._oFloatingContainerWrapper){this._oFloatingContainerWrapper=document.createElement("DIV");this._oFloatingContainerWrapper.setAttribute("id","sapUshellFloatingContainerWrapper");this._oFloatingContainerWrapper.classList.add("sapUshellShellFloatingContainerWrapper");this._oFloatingContainerWrapper.classList.add("sapUshellShellHidden");window.document.body.appendChild(this._oFloatingContainerWrapper)}if(this._oStorage&&this._oStorage.get("floatingContainerStyle")){this._oFloatingContainerWrapper.style.cssText=this._oStorage.get("floatingContainerStyle")}};p.prototype.renderFloatingContainer=function(e){this.renderFloatingContainerWrapper();if(e&&!e.getDomRef()){if(!this._oFloatingContainerWrapper.classList.contains("sapUshellShellHidden")){this._oFloatingContainerWrapper.classList.add("sapUshellShellHidden")}e.placeAt("sapUshellFloatingContainerWrapper")}};p.prototype.onThemeChanged=function(){return!!this.getDomRef()};p.prototype.setToolAreaVisible=function(t){this.setProperty("toolAreaVisible",!!t,true);if(this.getToolArea()){this.getToolArea().toggleStyleClass("sapUshellShellHidden",!t);this.applySplitContainerSecondaryContentSize();return this}if(t){sap.ui.require(["sap/ushell/EventHub"],function(e){e.emit("CreateToolArea")});return this}e.debug("Tool area not created but visibility updated",null,"sap.ushell.ShellLayout");return this};p.prototype.getToolAreaSize=function(){if(this.getToolAreaVisible()){if(this.getToolArea().hasItemsWithText()){return"15rem"}return"3.0625rem"}return"0"};p.prototype.setFooter=function(e){this.setAggregation("footer",e,true);this._renderFooter(e)};p.prototype.applySplitContainerSecondaryContentSize=function(){var e=this.getToolAreaSize();this.getCanvasSplitContainer().applySecondaryContentSize(e)};p.prototype.setFloatingContainer=function(e){this.setAssociation("floatingContainer",e,true);this.renderFloatingContainer(e)};p.prototype.setFloatingContainerVisible=function(e){this.setProperty("floatingContainerVisible",!!e,true);if(this.getDomRef()){var t=window.document.getElementById("sapUshellFloatingContainerWrapper");if(e&&this._oStorage&&!this._oStorage.get("floatingContainerStyle")){var a=o(".sapUshellShellHeadItm").position()?o(".sapUshellShellHeadItm").position().left:0;var i=(o(window).width()-o("#shell-floatingContainer").width()-a)*100/o(window).width();var l=o(".sapUshellShellHeader").height()*100/o(window).height();t.style.left=i+"%";t.style.top=l+"%";t.style.position="absolute";this._oStorage.put("floatingContainerStyle",t.style.cssText)}var n=window.document.querySelector(".sapUshellShellFloatingContainerWrapper");if(n&&e===n.classList.contains("sapUshellShellHidden")){n.classList.toggle("sapUshellShellHidden")}}return this};p.prototype.setFloatingActionsContainer=function(e){this.setAggregation("floatingActionsContainer",e,true)};p.prototype.setHeaderVisible=function(e){this.setProperty("headerVisible",e,true);var t=this.getDomRef();if(t){if(e===true){t.classList.remove("sapUshellShellNoHead")}else{t.classList.add("sapUshellShellNoHead")}}};p.prototype._setSidePaneWidth=function(e){var t=this.getCanvasSplitContainer();if(t){if(!e){e=i.media.getCurrentRange(i.media.RANGESETS.SAP_STANDARD).name}var a=p["_SIDEPANE_WIDTH_"+e.toUpperCase()]+"rem";t.setSecondaryContentSize(a)}};p.prototype._hideFooter=function(e,t){e.classList.remove("sapUshellShellFooterVisible");t.classList.add("sapUiHidden")};p.prototype._showFooter=function(e,t,i){if(i._applyContextClassFor){i._applyContextClassFor("footer")}this._oRm=this._oRm||a.createRenderManager();e.classList.add("sapUshellShellFooterVisible");t.classList.remove("sapUiHidden");this._oRm.render(i,t)};p.prototype._renderFooter=function(e){var t=this.getDomRef();if(!t){return}var a=t.querySelector("#"+this.getId()+"-footer");a.innerHTML="";if(!e){this._hideFooter(t,a);return}this._showFooter(t,a,e)};p.prototype._handleMediaChange=function(e){if(!this.getDomRef()){return}this._setSidePaneWidth(e.name)};return p});